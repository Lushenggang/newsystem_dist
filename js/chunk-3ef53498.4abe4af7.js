(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ef53498"],{1377:function(e,t,a){"use strict";var n=a("638e"),s=a.n(n);s.a},"15e3":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Cascader",{attrs:{data:e.professionalData,"change-on-select":""},on:{"on-change":e.select},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})},s=[],r=(a("7f7f"),a("ac4d"),a("8a81"),a("ac6a"),a("f400"),a("c5f6"),a("e668")),o={name:"professional-selector",props:{professionalId:{type:Number|String,required:!0}},data:function(){return{selected:[],professionalData:[],professionalMap:new Map}},created:function(){this.getProfessionalList()},watch:{professionalId:function(){this.makeSelected()}},computed:{},methods:{getProfessionalList:function(){var e=this;Object(r["getProfessionalList"])({}).then(function(t){t.response.success?(e.professionalData=e.makeData(t.data),e.makeSelected()):e.$Message.error(t.response.msg)}).catch(function(e){console.error(e)})},select:function(e,t){this.$emit("on-select",t[t.length-1])},makeData:function(e){var t=[],a=[],n=!0,s=!1,r=void 0;try{for(var o,i=e[Symbol.iterator]();!(n=(o=i.next()).done);n=!0){var c=o.value;c.value=c.id,c.label=c.name,this.professionalMap.set(c.id,c),c.parentId?a.push(c):t.push(c)}}catch(e){s=!0,r=e}finally{try{n||null==i.return||i.return()}finally{if(s)throw r}}for(var l=0;l<a.length;l++){var d=a[l],u=this.professionalMap.get(d.parentId);if(!u)return;u.children?u.children.push(d):u.children=[d]}return t},makeSelected:function(){if(this.professionalId&&this.professionalMap.size){this.selected=[this.professionalId];var e=this.professionalMap.get(this.professionalId),t=e?this.professionalMap.get(e.parentId):null;while(t)this.selected.splice(0,0,t.id),t=this.professionalMap.get(t.parentId)}}}},i=o,c=(a("1377"),a("2877")),l=Object(c["a"])(i,n,s,!1,null,null,null);l.options.__file="professional-selector.vue";var d=l.exports;t["a"]=d},"638e":function(e,t,a){},"848a":function(e,t,a){"use strict";var n=a("d31a"),s=a.n(n);s.a},"872d":function(e,t,a){},d31a:function(e,t,a){},d95d:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Layout",{staticClass:"tag-page"},[a("Row",{staticClass:"tool-bar"},[a("Button",{attrs:{type:"primary"},nativeOn:{click:function(t){e.addTag()}}},[e._v("添加标签")])],1),a("Row",{staticClass:"tag-list"},[a("Tree",{attrs:{data:e.tagData,"load-data":e.loadData,render:e.tagRender}})],1),a("Modal",{attrs:{"mask-closable":!1,loading:!0},on:{"on-ok":e.saveTag},model:{value:e.editTagModal,callback:function(t){e.editTagModal=t},expression:"editTagModal"}},[a("div",{attrs:{slot:"header"},slot:"header"},[e._v("\n      编辑标签\n    ")]),a("div",{staticClass:"add-tag-panel"},[a("Form",{attrs:{model:e.currentTag,"label-width":60}},[a("FormItem",{attrs:{label:"标签名称"}},[a("Input",{model:{value:e.currentTag.name,callback:function(t){e.$set(e.currentTag,"name",t)},expression:"currentTag.name"}})],1),a("FormItem",{attrs:{label:"对应专业"}},[a("professionalSelector",{attrs:{professionalId:e.currentTag.professionalId},on:{"on-select":e.selectProfessional}})],1),a("FormItem",{attrs:{label:"分值"}},[a("Input")],1),a("FormItem",{attrs:{label:"标签别名"}},[a("Input",{model:{value:e.currentTag.alias,callback:function(t){e.$set(e.currentTag,"alias",t)},expression:"currentTag.alias"}})],1)],1)],1)])],1)},s=[],r=(a("7f7f"),a("d28d")),o=a("15e3"),i=a("5d0b"),c={name:"",level:"",indexKey:"",alias:"",professionalId:0,sort:0,parentId:null},l={name:"tag",components:{professionalSelector:o["a"],tagSelector:i["a"]},data:function(){return{editTagModal:!1,tagData:[],currentTag:this.deepCopy(c),currentParentTag:null}},created:function(){this.getTagList()},methods:{getTagList:function(){var e=this;Object(r["getTagList"])({parentId:null}).then(function(t){t.response.success?e.tagData=t.data:e.$Message.error(t.response.msg)}).catch(function(e){console.error(e)})},tagRender:function(e,t){var a=this,n=(t.root,t.node),s=t.data;return e("span",[e("Tag",{props:{color:"success"},style:{marginRight:"0.5rem"}},s.name),e("Button",{props:{type:"primary",size:"small",icon:"md-add"},style:{marginRight:"0.2rem"},on:{click:function(){a.addTag(n)}}}),e("Button",{props:{type:"primary",size:"small",icon:"md-create"},style:{marginRight:"0.2rem"},on:{click:function(){a.editTag(n)}}}),e("Button",{props:{type:"error",size:"small",icon:"md-trash"},on:{click:function(){a.deleteTag(s)}}})])},loadData:function(e,t){var a=this;Object(r["getTagList"])({parentId:e.id}).then(function(e){e.response.success?(0===e.data.length&&a.$Message.info("没有更多标签！"),t(e.data)):a.$Message.error(e.response.msg)}).catch(function(e){console.error(e)})},addTag:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&(this.currentTag.parentId=e.node.id,this.currentParentTag=e),this.editTagModal=!0},editTag:function(e){this.currentTag=e.node,this.editTagModal=!0},selectProfessional:function(e){this.currentTag.professionalId=e.id},saveTag:function(){var e=this;Object(r["saveTag"])(this.currentTag).then(function(t){t.response.success?(e.$Message.success("保存成功！"),e.currentParentTag&&t.data.parentId?e.currentParentTag.node.expand&&e.currentParentTag.node.children.push(t.data):e.tagData.push(t.data),e.editTagModal=!1,e.currentParentTag=null,e.currentTag=e.deepCopy(c)):e.$Message.error(t.response.msg)}).catch(function(e){console.log(e)})},deleteTag:function(e){var t=this;this.$Modal.confirm({title:"提示",content:"将要删除所选标签及其所有下级标签，该操作不可撤销，请确定是否删除？",onCancel:function(){},onOk:function(){Object(r["deleteTag"])({ids:[e.id]}).then(function(e){e.response.success&&(t.$Message.success("删除成功！"),t.getTagList())})}})},selectParentTag:function(e){console.log(e)}}},d=l,u=(a("848a"),a("ee34d"),a("2877")),p=Object(u["a"])(d,n,s,!1,null,"21f43293",null);p.options.__file="Tag.vue";t["default"]=p.exports},ee34d:function(e,t,a){"use strict";var n=a("872d"),s=a.n(n);s.a}}]);
//# sourceMappingURL=chunk-3ef53498.4abe4af7.js.map