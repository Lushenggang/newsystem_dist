{"version":3,"sources":["webpack:///./src/knowledge/AreaManage.vue?21e7","webpack:///./src/knowledge/AreaManage.vue?3317","webpack:///src/knowledge/AreaManage.vue","webpack:///./src/knowledge/AreaManage.vue?8f63","webpack:///./src/knowledge/AreaManage.vue"],"names":["_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_AreaManage_vue_vue_type_style_index_0_id_402ad6b5_scoped_true_lang_stylus___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_AreaManage_vue_vue_type_style_index_0_id_402ad6b5_scoped_true_lang_stylus___WEBPACK_IMPORTED_MODULE_0___default","n","render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","type","nativeOn","click","$event","addArea","_v","data","areaData","treeRender","mask-closable","title","on","on-ok","saveArea","model","value","callback","$$v","editModal","expression","areaFormData","label","$set","_l","item","key","_s","staticRenderFns","AreaManagevue_type_script_lang_js_","code","id","level","name","parentId","sort","areaTypes","created","getAreaList","methods","h","_ref","_this","root","node","props","color","icon","size","parent","arguments","length","undefined","_this2","Object","api_area","then","_ref2","response","success","$Message","error","msg","_this3","allDescendant","_ref3","makeData","list","rootLevel","subLevel","areaMap","Map","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","set","expand","push","err","return","_i","_item","parentNode","get","children","knowledge_AreaManagevue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__"],"mappings":"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","file":"js/chunk-3f75046c.d4281571.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AreaManage.vue?vue&type=style&index=0&id=402ad6b5&scoped=true&lang=stylus&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AreaManage.vue?vue&type=style&index=0&id=402ad6b5&scoped=true&lang=stylus&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Layout',{staticClass:\"area-manager\"},[_c('Button',{attrs:{\"type\":\"primary\"},nativeOn:{\"click\":function($event){_vm.addArea()}}},[_vm._v(\"添加\")]),_c('Tree',{attrs:{\"data\":_vm.areaData,\"render\":_vm.treeRender}}),_c('Modal',{attrs:{\"mask-closable\":false,\"title\":\"编辑地区\"},on:{\"on-ok\":_vm.saveArea},model:{value:(_vm.editModal),callback:function ($$v) {_vm.editModal=$$v},expression:\"editModal\"}},[_c('Form',{attrs:{\"model\":_vm.areaFormData}},[_c('FormItem',{attrs:{\"label\":\"类型\"}},[_c('Select',{model:{value:(_vm.areaFormData.type),callback:function ($$v) {_vm.$set(_vm.areaFormData, \"type\", $$v)},expression:\"areaFormData.type\"}},_vm._l((_vm.areaTypes),function(item){return _c('Option',{key:item.value,attrs:{\"value\":item.value}},[_vm._v(_vm._s(item.title))])}))],1),_c('FormItem',{attrs:{\"label\":\"名称\"}},[_c('Input',{model:{value:(_vm.areaFormData.name),callback:function ($$v) {_vm.$set(_vm.areaFormData, \"name\", $$v)},expression:\"areaFormData.name\"}})],1),_c('FormItem',{attrs:{\"label\":\"排序\"}},[_c('Input',{model:{value:(_vm.areaFormData.sort),callback:function ($$v) {_vm.$set(_vm.areaFormData, \"sort\", $$v)},expression:\"areaFormData.sort\"}})],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <Layout class=\"area-manager\">\n    <Button type=\"primary\" @click.native=\"addArea()\">添加</Button>\n    <Tree :data=\"areaData\" :render=\"treeRender\" />\n    <Modal\n      v-model=\"editModal\"\n      :mask-closable=\"false\"\n      title=\"编辑地区\"\n      @on-ok=\"saveArea\">\n      <Form :model=\"areaFormData\">\n        <FormItem label=\"类型\">\n          <Select v-model=\"areaFormData.type\">\n            <Option v-for=\"item in areaTypes\" :value=\"item.value\" :key=\"item.value\">{{item.title}}</Option>\n          </Select>\n        </FormItem>\n        <FormItem label=\"名称\">\n          <Input v-model=\"areaFormData.name\" />\n        </FormItem>\n        <FormItem label=\"排序\">\n          <Input v-model=\"areaFormData.sort\" />\n        </FormItem>\n      </Form>\n    </Modal>\n  </Layout>\n</template>\n\n<script>\nimport { saveArea, getAreaList } from '@/api/area'\n\nexport default {\n  data () {\n    return {\n      areaData: [],\n      editModal: false,\n      areaFormData: {\n        code: '',\n        id: null,\n        level: 0,\n        name: '',\n        parentId: null,\n        sort: 0,\n        type: 0\n      },\n      areaTypes: [\n        {\n          value: 1,\n          title: '国家'\n        },\n        {\n          value: 2,\n          title: '中央部委'\n        },\n        {\n          value: 3,\n          title: '省'\n        },\n        {\n          value: 4,\n          title: '市'\n        },\n        {\n          value: 5,\n          title: '区县'\n        }\n      ]\n    }\n  },\n  created () {\n    this.getAreaList()\n  },\n  methods: {\n    treeRender (h, { root, node, data }) {\n      return h(\n        'span',\n        [\n          h(\n            'Tag',\n            {\n              props: {\n                color: 'success'\n              }\n            },\n            data.name\n          ),\n          h(\n            'Button',\n            {\n              props: {\n                type: 'primary',\n                icon: 'md-add',\n                size: 'small'\n              },\n              nativeOn: {\n                click: () => {\n                  this.addArea(data)\n                }\n              }\n            }\n          )\n        ]\n      )\n    },\n    addArea (parent = null) {\n      this.areaFormData = {\n        code: '',\n        id: null,\n        level: 0,\n        name: '',\n        parentId: parent ? parent.id : null,\n        sort: 0,\n        type: 0\n      }\n      this.editModal = true\n    },\n    saveArea () {\n      saveArea(this.areaFormData).then(({ data, response }) => {\n        if (response.success) {\n          this.$Message.success('保存成功！')\n          this.getAreaList()\n        } else {\n          this.$Message.error(response.msg)\n        }\n      })\n    },\n    getAreaList () {\n      getAreaList({\n        allDescendant: true\n      }).then(({ data, response }) => {\n        this.areaData = this.makeData(data)\n      })\n    },\n    makeData (list) {\n      const rootLevel = []\n      const subLevel = []\n      const areaMap = new Map()\n      // 生成map，分拣出根级数据和子集\n      for (let item of list) {\n        areaMap.set(item.id, item)\n        item.expand = true\n        if (!item.parentId) {\n          rootLevel.push(item)\n        } else {\n          subLevel.push(item)\n        }\n      }\n\n      // 将子集数据放入父级节点的chidren中\n      for (let item of subLevel) {\n        const parentNode = areaMap.get(item.parentId)\n        if (!parentNode) {\n          return\n        }\n        if (parentNode.children) {\n          parentNode.children.push(item)\n        } else {\n          parentNode.children = [ item ]\n        }\n      }\n\n      return rootLevel\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"stylus\">\n.area-manager\n  background none\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AreaManage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AreaManage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AreaManage.vue?vue&type=template&id=402ad6b5&scoped=true&\"\nimport script from \"./AreaManage.vue?vue&type=script&lang=js&\"\nexport * from \"./AreaManage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AreaManage.vue?vue&type=style&index=0&id=402ad6b5&scoped=true&lang=stylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"402ad6b5\",\n  null\n  \n)\n\ncomponent.options.__file = \"AreaManage.vue\"\nexport default component.exports"],"sourceRoot":""}