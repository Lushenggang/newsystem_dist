(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d4c126e"],{"53e1":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Layout",{staticClass:"bind-wx-page"},[n("weixinLogin",{attrs:{title:"扫描二维码绑定微信",type:"bind"},on:{success:e.wxLoginSuccess}})],1)},i=[],s=(n("a481"),n("76bc")),c=n("7e70"),r={name:"force-bind-wx",components:{weixinLogin:s["a"]},methods:{wxLoginSuccess:function(e){var t=this;Object(c["wxLogin"])({code:e}).then(function(e){e.response.success?t.bindSuccess(e.data.token,e.data.user):(console.error("微信登录失败"),t.bindFailed(e.response.msg))}).catch(function(e){console.error(e),t.loginFailed(e)})},bindSuccess:function(e,t){var n=this,o=this.deepCopy(this.$store.getters["user/userInfo"]);Object(c["bindWx"])({id:o.id,unionid:t.unionid}).then(function(e){e.response.success?(o.unionid=t.unionid,n.$store.commit("user/setUserInfo",o),n.$router.replace({name:"Home"})):n.$Message.error(e.response.msg)}).catch(function(e){console.error(e)})},bindFailed:function(e){this.$Message.error(e)}}},u=r,a=(n("f5ae"),n("2877")),d=Object(a["a"])(u,o,i,!1,null,"3ac0c16e",null);d.options.__file="BindWX.vue";t["default"]=d.exports},"76bc":function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Layout",[n("div",{attrs:{id:"qrcode"}},[n("h2",[e._v(e._s(e.title))]),n("img",{attrs:{src:e.qrCode}}),n("div",{staticClass:"show-msg"},[e._v(e._s(e.wxLoginMsg))])])])},i=[],s=n("7ded"),c={name:"weixin-login",props:{type:{type:String,required:!1,default:"login"},title:String},data:function(){return{wxUUID:"",qrCode:"",wxLoginMsg:"请用微信扫描二维码登录"}},created:function(){this.getQRCode()},methods:{getQRCode:function(){var e=this;Object(s["getQRCode"])().then(function(t){t.status;var n=t.result;e.wxUUID=n.wxUUID,e.qrCode=n.imgData,e.getWxCode(e.wxUUID)})},getWxCode:function(){var e=this;Object(s["getWxCode"])({uuid:this.wxUUID}).then(function(t){var n=t.result,o=t.status,i=t.msg;if(o&&405===o)e.wxLoginMsg=i,e.$emit("success",n.code);else if(500===o)e.getQRCode();else{o&&404===o&&(e.wxLoginMsg=i.title+", "+i.content);var s=setTimeout(function(){e.getWxCode(),clearTimeout(s)},2e3);console.log(n)}}).catch(function(t){var n=setTimeout(function(){e.getWxCode(),clearTimeout(n)},2e3);console.error(t)})}}},r=c,u=n("2877"),a=Object(u["a"])(r,o,i,!1,null,null,null);a.options.__file="weixin-login.vue";var d=a.exports;t["a"]=d},e968:function(e,t,n){},f5ae:function(e,t,n){"use strict";var o=n("e968"),i=n.n(o);i.a}}]);
//# sourceMappingURL=chunk-5d4c126e.18aba271.js.map