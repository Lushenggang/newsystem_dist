(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-20e65cc9","chunk-8b5b7c9a"],{"0d06":function(e,t,n){"use strict";var s=n("68b7"),r=n.n(s);r.a},"15f0":function(e,t,n){},3442:function(e,t,n){"use strict";var s=n("bdfa"),r=n.n(s);r.a},"3b1a":function(e,t,n){},"5e66":function(e,t,n){},"642b":function(e,t,n){"use strict";var s=n("3b1a"),r=n.n(s);r.a},"68b7":function(e,t,n){},"6b97":function(e,t,n){"use strict";var s=n("c4bd"),r=n.n(s);r.a},b2b9:function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"answerRecord",staticClass:"answer-record-page"},[e.recordId?e._e():n("div",{staticClass:"answer-record-filter"},[n("div",{staticClass:"filter-title"},[e._v("根项目：")]),n("Select",{staticClass:"filter-select",model:{value:e.rootProject,callback:function(t){e.rootProject=t},expression:"rootProject"}},e._l(e.projectList,function(t,s){return n("Option",{key:s,attrs:{value:t.id}},[e._v("\n        "+e._s(t.name)+"\n      ")])})),n("div",{staticClass:"filter-title"},[e._v("子项目：")]),n("Select",{staticClass:"filter-select",model:{value:e.childProject,callback:function(t){e.childProject=t},expression:"childProject"}},e._l(e.childrenList,function(t,s){return n("Option",{key:s,attrs:{value:t.id}},[e._v("\n        "+e._s(t.name)+"\n      ")])}))],1),e.recordId?n("div",{staticClass:"detail"},[n("div",{staticClass:"detail-menu"},[n("div",{staticClass:"project-data"},[n("div",{staticClass:"project-name",on:{click:e.pushToPage}},[e._v("\n          "+e._s(e.projectInfo.name)+"\n        ")]),e._v("\n          的做题记录\n      ")]),e._m(0)]),n("div",{staticClass:"detail-content"},[n("div",{staticClass:"answer-record"},[n("div",{staticClass:"answer-record-title"},[e._v("\n          做题记录\n        ")]),e.recordDetail.length?n("Tree",{staticClass:"answer-record-tree",attrs:{treeData:e.recordDetail,nodeClass:"tree-node-container",expand:!1},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.data,r=t.parentData;return n("div",{staticClass:"node-render-content",class:{"root-node-content":r.isRoot}},[r.isRoot?n("span",{staticClass:"root-node-title"},[e._v("\n              "+e._s(r.children.findIndex(function(e){return e.id===s.id})+1+". ")+"\n            ")]):e._e(),e._v("\n            "+e._s(s.title)+"\n          ")])}}])}):n("div",{staticClass:"notice"},[e._v("\n          无详细记录信息\n        ")])],1),n("div",{staticClass:"report"},[n("div",{staticClass:"report-title"},[e._v("报告")]),n("div",{staticClass:"report-content"},[n("div",{staticClass:"content",domProps:{innerHTML:e._s(e.reportContent)}})])])])]):n("div",{ref:"table",staticClass:"table"},[n("Table",{attrs:{height:e.tableHeight,columns:e.columns,data:e.recordList,width:e.size.width,border:""}})],1)])},r=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"answer-menu"},[n("div",[e._v("设为测试用例")])])}],i=(n("ac4d"),n("8a81"),n("ac6a"),n("20d6"),n("8afe")),a=(n("96cf"),n("3040")),o=(n("cadf"),n("551c"),n("097d"),n("2ac8")),c=n("52e7"),u=n("339e"),l=n.n(u),d=n("24d2"),p={components:{Tree:c["a"]},data:function(){var e=this;return{projectInfo:{},recordList:[],columns:[{title:"项目名称",key:"projectName",sortable:!0},{title:"客户",key:"customer",sortable:!0},{title:"用户标识",key:"userId",sortable:!0},{title:"联系电话",key:"phone",sortable:!0},{title:"设备",key:"device",sortable:!0},{title:"IP",key:"ip",sortable:!0},{title:"做题时间",key:"updateTime",sortable:!0},{title:"做题时长",key:"time",sortable:!0},{title:"步骤",key:"step",sortable:!0},{title:"操作",key:"action",align:"center",render:function(t,n){return t("div",[t("Button",{props:{type:"primary"},on:{click:function(){e.showRecordDetail(n.index)}}},"详情")])}}],size:{width:0,height:0},tableHeight:0,recordDetail:[],reportContent:"",converter:null,projectList:[{id:"default",name:"全部项目"}],childrenList:[{id:"default",name:"全部子项目"}],childProject:"default",rootProject:"default"}},computed:{recordId:function(){return this.$route.query.recordId||""},all:function(){return"default"===this.childProject},lookProject:function(){var e=this.childProject;return"default"===e&&(e="default"===this.rootProject?"":this.rootProject),e}},watch:{recordId:function(){this.recordId&&(this.calSize(),this.getRecordDetail(),this.getReportContent(this.recordId),this.getProjectDetail())},rootProject:function(e,t){e!==t&&this.getChildProjectList()},lookProject:{immediate:!0,handler:function(){var e=this;this.$nextTick(function(){e.getRecordList()})}}},mounted:function(){this.childProject=this.$route.query.projectId||"default",this.rootProject=this.$route.query.rootId||"default",this.converter||(this.converter=new l.a.Converter({literalMidWordUnderscores:!0})),this.calSize(),this.getProjectList(),window.addEventListener("resize",this.calSize),this.recordId&&(this.getRecordDetail(),this.getReportContent(this.recordId)),this.getProjectDetail()},beforeDestroy:function(){window.removeEventListener("resize",this.calSize)},methods:{getProjectList:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){var t,n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={},e.next=3,d["default"].getRootProjectList(t);case 3:n=e.sent,n&&(this.projectList=[{id:"default",name:"全部项目"}],(s=this.projectList).push.apply(s,Object(i["a"])(n)));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getChildProjectList:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){var t,n,s,r,a,o=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.childrenList=[{id:"default",name:"全部子项目"}],!this.rootProject||"default"===this.rootProject){e.next=8;break}return t={id:this.rootProject},e.next=5,d["default"].getProjectList(t);case 5:n=e.sent,n&&(r=n.findIndex(function(e){return e.id===o.rootProject}),-1!==r&&(a=n.splice(r,1),n.unshift.apply(n,Object(i["a"])(a))),(s=this.childrenList).push.apply(s,Object(i["a"])(n))),-1===n.findIndex(function(e){return e.id===o.childProject})&&(this.childProject="default");case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getRecordList:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){var t,n,s,r,i,a,c,u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={projectId:this.lookProject},e.next=3,o["default"].getHistoryAnswerRecord.apply(this,[t]);case 3:for(n=e.sent,s=!0,r=!1,i=void 0,e.prev=7,a=n[Symbol.iterator]();!(s=(c=a.next()).done);s=!0)u=c.value,u.time=Math.round((u.updateTime-u.createTime)/1e3)+" s",u.updateTime=this.formatTime(u.updateTime);e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](7),r=!0,i=e.t0;case 15:e.prev=15,e.prev=16,s||null==a.return||a.return();case 18:if(e.prev=18,!r){e.next=21;break}throw i;case 21:return e.finish(18);case 22:return e.finish(15);case 23:this.recordList=n||[];case 24:case"end":return e.stop()}},e,this,[[7,11,15,23],[16,,18,22]])}));return function(){return e.apply(this,arguments)}}(),getProjectDetail:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.$route.query.detailId){e.next=4;break}return e.next=3,d["default"].getProjectDetail({id:this.$route.query.detailId});case 3:this.projectInfo=e.sent;case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),showRecordDetail:function(e){var t=this.recordList[e];this.$router.push({name:"AnswerRecord",query:{detailId:t.projectId,recordId:t.id}})},getRecordDetail:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={recordId:this.recordId},e.next=3,o["default"].getAnswerRecord.apply(this,[t]);case 3:n=e.sent,n?this.recordDetail=n:this.$Message.error("获取做题记录失败");case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getReportContent:function(){var e=Object(a["a"])(regeneratorRuntime.mark(function e(t){var n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n={recordId:t},e.next=3,o["default"].getReportContent.apply(this,[n]);case 3:s=e.sent,this.reportContent=this.converter.makeHtml(s);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),calSize:function(){var e=this;this.$nextTick(function(){var t=e.$refs.answerRecord.getBoundingClientRect();e.size={width:t.width,height:t.height},e.$refs.table&&(t=e.$refs.table.getBoundingClientRect(),e.tableHeight=t.height)})},formatTime:function(e){var t=function(e){return e<10?"0"+e:e},n=new Date(e),s=n.getFullYear(),r=t(n.getMonth()+1),i=t(n.getDay()),a=t(n.getHours()),o=t(n.getMinutes()),c="".concat(s,"-").concat(r,"-").concat(i," ").concat(a,":").concat(o);return c},pushToPage:function(e){this.$router.push({name:"Page",params:{projectId:this.rootProject},query:{currentProject:e}})}}},m=p,f=(n("0d06"),n("2877")),h=Object(f["a"])(m,s,r,!1,null,null,null);h.options.__file="AnswerRecord.vue";t["default"]=h.exports},bc13:function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Layout",{staticClass:"home-page"},[n("div",{staticClass:"content"},[n("div",{staticClass:"content-home"},[n("div",{staticClass:"content-left",class:e.menuShow?"":"content-left-hide-menu"},[n("ul",{directives:[{name:"show",rawName:"v-show",value:e.menuShow,expression:"menuShow"}],staticClass:"type-list"},[e._l(e.showItems,function(t,s){return n("li",{key:s,class:{"type-list-item":!0,"choose-show":e.showType===t.name},on:{click:function(n){e.setShowType(t.name)}}},[n("i",{staticClass:"icon"},[n("Icon",{attrs:{type:t.icon}})],1),e._v("              "+e._s(t.title))])}),n("li",{staticClass:"type-list-item",on:{click:function(t){e.$router.push({path:"/layout/knowledge"})}}},[n("i",{staticClass:"icon"},[n("Icon",{attrs:{type:"ios-book"}})],1),e._v("              knowledge")]),n("li",{staticClass:"type-list-item",on:{click:function(t){e.$router.push({path:"/answerRecord"})}}},[n("i",{staticClass:"icon"},[n("Icon",{attrs:{type:"md-book"}})],1),e._v("咨询记录")])],2),n("div",{staticClass:"menu-fold",on:{click:function(t){t.stopPropagation(),e.menuShow=!e.menuShow}}},[e.menuShow?n("Icon",{staticClass:"show-icon",attrs:{type:"ios-arrow-left",title:"隐藏"}}):n("Icon",{staticClass:"show-icon",attrs:{title:"展开",type:"ios-arrow-right"}})],1)]),n("div",{staticClass:"content-right"},["project"===e.showType?[n("ProjectBoard")]:e._e(),"member"===e.showType?[n("Member")]:e._e(),"orgnization"===e.showType?[n("Orgnization")]:e._e(),"customComponent"===e.showType?[n("CustomComponentManage")]:e._e(),"networkDisk"===e.showType?[n("NetworkDisk")]:e._e()],2)])])])},r=[],i=(n("7f7f"),n("7514"),n("cadf"),n("551c"),n("097d"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"org-info"},[n("div",{staticClass:"org-list"},[n("h2",{staticClass:"org-title"},[e._v("公司")]),n("ul",e._l(e.companyList,function(t,s){return n("li",{key:s},[n("Button",{staticClass:"org-item"},[n("span",{staticClass:"org-edit",on:{click:function(n){n.stopPropagation(),e.editCompanyInfo(t)}}},[n("Icon",{attrs:{type:"md-create"}})],1),n("span",{staticClass:"org-name"},[e._v("\n            "+e._s(t.name)+"\n          ")])])],1)}))]),n("div",{staticClass:"org-list"},[n("h2",{staticClass:"org-title"},[e._v("团队列表")]),n("ul",[e._l(e.teamList,function(t,s){return n("li",{key:s},[n("Button",{staticClass:"org-item"},[n("span",{staticClass:"org-edit",on:{click:function(n){n.stopPropagation(),e.editTeamInfo(t)}}},[n("Icon",{attrs:{type:"md-create"}})],1),n("span",{staticClass:"org-name"},[e._v("\n            "+e._s(t.name)+"\n          ")]),n("span",{staticClass:"org-delete",on:{click:function(n){n.stopPropagation(),e.removeOrg(t.id)}}},[n("Icon",{attrs:{type:"md-close"}})],1)])],1)}),n("li",[n("Button",{staticClass:"org-add",on:{click:function(t){e.addTeam()}}},[n("Icon",{attrs:{type:"md-add"}})],1)],1)],2)]),n("Modal",{attrs:{"class-name":"vertical-center-modal","ok-text":"保存","cancel-text":"取消"},on:{"on-ok":function(t){e.saveTeamEdit()}},model:{value:e.teamEdit,callback:function(t){e.teamEdit=t},expression:"teamEdit"}},[n("div",{staticClass:"org-edit"},[n("div",{staticClass:"edit-line"},[n("span",{staticClass:"edit-title"},[e._v("名称")]),n("Input",{model:{value:e.teamData.name,callback:function(t){e.$set(e.teamData,"name",t)},expression:"teamData.name"}})],1),n("div",{staticClass:"edit-line"},[n("div",{staticClass:"eidt-title"},[e._v("成员")]),e._l(e.memberList,function(t,s){return n("Button",{key:s,staticClass:"edit-user",attrs:{type:-1!==e.userChange.delUserIds.indexOf(t.id)?"":"primary"}},[e._v("\n          "+e._s(t.name)+"\n          "),-1!==e.userChange.delUserIds.indexOf(t.id)?n("span",{staticClass:"delete-user",on:{click:function(n){n.stopPropagation(),e.cancelRemoveUser(t.id)}}},[n("Icon",{attrs:{type:"md-add"}})],1):n("span",{staticClass:"delete-user",on:{click:function(n){n.stopPropagation(),e.removeOrgUser(t.id,1)}}},[n("Icon",{attrs:{type:"md-close"}})],1)])}),e._l(e.userChange.addUserIds,function(t,s){return n("Button",{key:s,staticClass:"edit-user",attrs:{type:"success"}},[e._v("\n          "+e._s(t.name)+"\n          "),n("span",{staticClass:"delete-user",on:{click:function(n){n.stopPropagation(),e.removeOrgUser(t.id,2)}}},[n("Icon",{attrs:{type:"md-close"}})],1)])}),n("div",{staticClass:"add-user"},[n("Select",{attrs:{filterable:"",remote:"",multiple:"","remote-method":e.generateReadyList,loading:e.loading},model:{value:e.userAdd,callback:function(t){e.userAdd=t},expression:"userAdd"}},e._l(e.readyList,function(t,s){return n("Option",{key:s,attrs:{value:t.id}},[e._v(e._s(t.name))])})),n("Button",{on:{click:function(t){e.addUserToOrg()}}},[n("Icon",{attrs:{type:"md-add"}})],1)],1)],2)])]),n("Modal",{attrs:{"class-name":"vertical-center-modal","ok-text":"保存","cancel-text":"取消"},on:{"on-ok":function(t){e.saveCompanyEdit()}},model:{value:e.companyEdit,callback:function(t){e.companyEdit=t},expression:"companyEdit"}},[n("div",{staticClass:"edit-line"},[n("h2",[e._v(e._s(e.companyData.name))])]),n("div",{staticClass:"org-edit"},[n("div",{staticClass:"edit-line"},[n("div",{staticClass:"eidt-title"},[e._v("成员")]),e._l(e.memberList,function(t,s){return n("Button",{key:s,staticClass:"edit-user",attrs:{type:-1!==e.userChange.delUserIds.indexOf(t.id)?"":"primary"}},[e._v("\n          "+e._s(t.name)+"\n          "),-1!==e.userChange.delUserIds.indexOf(t.id)?n("span",{staticClass:"delete-user",on:{click:function(n){n.stopPropagation(),e.cancelRemoveUser(t.id)}}},[n("Icon",{attrs:{type:"md-add"}})],1):n("span",{staticClass:"delete-user",on:{click:function(n){n.stopPropagation(),e.removeOrgUser(t.id,1)}}},[n("Icon",{attrs:{type:"md-close"}})],1)])}),e._l(e.userChange.addUserIds,function(t,s){return n("Button",{key:s,staticClass:"edit-user",attrs:{type:"success"}},[e._v("\n          "+e._s(t.name)+"\n          "),n("span",{staticClass:"delete-user",on:{click:function(n){n.stopPropagation(),e.removeOrgUser(t.id,2)}}},[n("Icon",{attrs:{type:"md-close"}})],1)])}),n("div",{staticClass:"add-user"},[n("Select",{attrs:{filterable:"",remote:"",multiple:"","remote-method":e.generateReadyList,loading:e.loading},model:{value:e.userAdd,callback:function(t){e.userAdd=t},expression:"userAdd"}},e._l(e.readyList,function(t,s){return n("Option",{key:s,attrs:{value:t.id}},[e._v(e._s(t.name))])})),n("Button",{on:{click:function(t){e.addUserToOrg()}}},[n("Icon",{attrs:{type:"md-add"}})],1)],1)],2)])])],1)}),a=[],o=(n("ac4d"),n("8a81"),n("ac6a"),n("96cf"),n("3040")),c=n("24fd"),u={name:"org-board",data:function(){return{teamEdit:!1,companyEdit:!1,teamList:[],teamData:{id:0,name:""},companyData:{id:0,name:""},memberList:[],userList:[],readyList:[],userAdd:[],loading:!1,userChange:{orgId:0,addUserIds:[],delUserIds:[]}}},methods:{getTeamList:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["default"].getTeamList({});case 2:t=e.sent,t&&(this.teamList=t.result);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),addTeam:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["default"].addTeam({createUserId:201,name:"未命名"});case 2:t=e.sent,t&&this.teamList.push(t);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),removeOrg:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["default"].removeOrg(t);case 2:n=e.sent,n&&this.getTeamList();case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),editTeamInfo:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.teamEdit=!0,this.userChange={orgId:t.id,addUserIds:[],delUserIds:[]},this.teamData={id:t.id,name:t.name},e.next=5,c["default"].editTeamInfo();case 5:return n=e.sent,n&&(this.memberList=n.data.data.userAOList),e.next=9,c["default"].editTeamInfo1({});case 9:n=e.sent,n&&(this.userList=n.data.data.result),console.log("editteaminfo");case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),generateReadyList:function(e){var t=this;""!==e?(this.loading=!0,setTimeout(function(){t.loading=!1,t.readyList=t.userList.filter(function(t){return t.name.indexOf(e)>-1})},200)):this.readyList=[]},removeOrgUser:function(e,t){if(1===t)this.userChange.delUserIds.push(e);else if(2===t){var n=-1,s=!0,r=!1,i=void 0;try{for(var a,o=this.userAdd[Symbol.iterator]();!(s=(a=o.next()).done);s=!0){var c=a.value;if(n++,c.id===e)break}}catch(e){r=!0,i=e}finally{try{s||null==o.return||o.return()}finally{if(r)throw i}}n>=-1&&this.userChange.addUserIds.splice(n,1)}},cancelRemoveUser:function(e){var t=this.userChange.delUserIds.indexOf(e);t>-1&&this.userChange.delUserIds.splice(t,1)},addUserToOrg:function(){var e=this,t=!0,n=!1,s=void 0;try{for(var r,i=function(){var t=r.value;if(e.userAdd.indexOf(t.id)>-1){var n=e.userChange.addUserIds.filter(function(e){return e.id===t.id}),s=e.memberList.filter(function(e){return e.id===t.id});0===n.length&&0===s.length&&e.userChange.addUserIds.push(t)}},a=this.userList[Symbol.iterator]();!(t=(r=a.next()).done);t=!0)i()}catch(e){n=!0,s=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw s}}this.userAdd=[]},saveTeamEdit:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["default"].saveTeamEdit(this.teamData);case 2:if(t=e.sent,t?(this.getTeamList(),this.$Message.success("保存成功")):this.$Message.error("保存失败"),0===this.userChange.addUserIds.length&&0===this.userChange.delUserIds.length){e.next=12;break}return n={orgId:this.userChange.orgId,addUserIds:[],delUserIds:[]},this.userChange.addUserIds.map(function(e){n.addUserIds.push(e.id)}),this.userChange.delUserIds.map(function(e){n.delUserIds.push(e.id)}),e.next=10,c["default"].saveTeamEdit1(n);case 10:t=e.sent,t&&this.$Message.success("保存成功");case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),editCompanyInfo:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.companyEdit=!0,this.userChange={orgId:t.id,addUserIds:[],delUserIds:[]},this.companyData={id:t.id,name:t.name},e.next=5,Request.put({companyId:t.id});case 5:return n=e.sent,200===n.status&&0===n.data.response.code&&(this.memberList=n.data.data),console.log(n,"editCompanyInfo",t.id),e.next=10,c["default"].editCompanyInfo1({});case 10:n=e.sent,200===n.status&&0===n.data.response.code&&(this.userList=n.data.data.result);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),saveCompanyEdit:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(0===this.userChange.addUserIds.length&&0===this.userChange.delUserIds.length){e.next=8;break}return t={orgId:this.userChange.orgId,addUserIds:[],delUserIds:[]},this.userChange.addUserIds.map(function(e){t.addUserIds.push(e.id)}),this.userChange.delUserIds.map(function(e){t.delUserIds.push(e.id)}),e.next=6,c["default"].saveCompanyEdit(t);case 6:n=e.sent,200===n.status&&0===n.data.response.code&&this.$Message.success("保存成功");case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},computed:{companyList:function(){return this.$store.state.user.companyList}},mounted:function(){this.getTeamList(),setInterval(function(){},2e3)},watch:{teamEdit:function(e,t){t||this.getTeamList()}}},l=u,d=(n("642b"),n("2877")),p=Object(d["a"])(l,i,a,!1,null,"9d179f14",null);p.options.__file="org-board.vue";var m=p.exports,f=m,h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"team-member-page"},[n("div",{staticClass:"title"},[e._v("团队")]),n("div",{staticClass:"page-content"},[n("div",{staticClass:"team-list"},[n("div",{staticClass:"personal-team"},[n("div",{staticClass:"team-title",on:{click:function(t){t.stopPropagation(),e.fold.personal=!e.fold.personal}}},[n("div",{staticClass:"divide-line"}),n("span",[e._v("个人团队")]),e.fold.personal?n("Icon",{staticClass:"md-fold",attrs:{type:"ios-arrow-back"}}):n("Icon",{staticClass:"md-fold",attrs:{type:"ios-arrow-down"}}),n("div",{staticClass:"divide-line"})],1),e.fold.personal?e._e():[n("div",{staticClass:"team team-add"},[n("div",{staticClass:"team-add-icon",on:{click:function(t){t.stopPropagation(),e.tryAddTeam(1)}}},[n("Icon",{attrs:{type:"md-add"}})],1)]),e._l(e.teamList,function(t,s){return t.companyId?e._e():n("div",{key:s,class:{team:!0,"current-team":e.currentTeam.id===t.id},on:{click:function(n){n.stopPropagation(),e.lookAtTeam(t.id)}}},[n("div",{staticClass:"team-icon"},[n("Icon",{attrs:{type:"md-people"}})],1),n("div",{staticClass:"team-name"},[e._v(e._s(t.name))])])})]],2),n("div",{staticClass:"company-team"},[n("div",{staticClass:"team-title",on:{click:function(t){t.stopPropagation(),e.fold.company=!e.fold.company}}},[n("div",{staticClass:"divide-line"}),n("span",[e._v("公司团队")]),e.fold.company?n("Icon",{staticClass:"md-fold",attrs:{type:"ios-arrow-back"}}):n("Icon",{staticClass:"md-fold",attrs:{type:"ios-arrow-down"}}),n("div",{staticClass:"divide-line"})],1),e.fold.company?e._e():[n("div",{staticClass:"team team-add"},[n("div",{staticClass:"team-add-icon",on:{click:function(t){t.stopPropagation(),e.tryAddTeam(2)}}},[n("Icon",{attrs:{type:"md-add"}})],1)]),e._l(e.teamList,function(t,s){return t.companyId?n("div",{key:s,class:{team:!0,"current-team":e.currentTeam.id===t.id},on:{click:function(n){n.stopPropagation(),e.lookAtTeam(t.id)}}},[n("div",{staticClass:"team-icon"},[n("Icon",{attrs:{type:"md-people"}})],1),n("div",{staticClass:"team-name"},[e._v(e._s(t.name))])]):e._e()})]],2)]),this.currentTeam.id?n("div",{staticClass:"team-detail"},[n("div",{staticClass:"detail-title"},[n("div",{staticClass:"title-edit"},[e.roleInfo.userType!==e.constMap.member||e.userInfo.userType!==e.constMap.member?n("Icon",{staticClass:"edit-title-button",attrs:{type:"ios-create"},on:{click:function(t){return t.stopPropagation(),e.editTeam(t)}}}):e._e(),n("span",{staticClass:"title-text"},[e._v(e._s(e.currentTeam.name))])],1),e.roleInfo.userType!==e.constMap.member||e.userInfo.userType!==e.constMap.member?n("div",{staticClass:"team-menu"},[n("div",{staticClass:"member-add"},[n("Button",{attrs:{type:"success"},on:{click:function(t){t.stopPropagation(),e.addMember()}}},[e._v("添加成员")])],1),n("div",{staticClass:"team-delete"},[n("Button",{attrs:{type:"default"},on:{click:function(t){return t.stopPropagation(),e.tryRemoveTeam(t)}}},[e._v("解散团队")])],1)]):e._e()]),n("div",{staticClass:"detail-member"},e._l(e.currentTeam.list,function(t){return n("div",{key:t.id,class:{"detail-item":!0,"member-self":e.userInfo.id===t.id}},[n("div",{staticClass:"avatar"},[n("img",{staticClass:"avatar-img",attrs:{src:t.avatar?e.$avatarUrl.replace("avatarID",t.avatar):"@/assets/logo.png",alt:"用户头像"}}),t.name?n("div",{staticClass:"user-name"},[e._v(e._s(t.name))]):e._e()]),n("div",{staticClass:"user-info"},[t.userType===e.constMap.manager?n("div",{staticClass:"info-item"},[n("Icon",{staticClass:"info-icon",attrs:{type:"md-person"}}),n("span",{staticClass:"info-content"},[e._v("管理员")])],1):e._e()]),n("div",{staticClass:"menu"},[e.userInfo.userType===e.constMap.member&&e.roleInfo.userType===e.constMap.member||e.userInfo.id===t.id?e._e():n("Select",{staticStyle:{width:"6rem"},attrs:{transfer:!0},on:{"on-change":function(n){e.changePermission(t)}},model:{value:t.userType,callback:function(n){e.$set(t,"userType",n)},expression:"member.userType"}},e._l(e.userTypeList,function(t,s){return n("Option",{key:s,attrs:{value:t.code}},[e._v("\n                "+e._s(t.name)+"\n              ")])})),e.userInfo.id===t.id?n("Button",{on:{click:function(n){n.stopPropagation(),e.deleteMember(t)}}},[e._v("\n              退出\n            ")]):e.userInfo.userType!==e.constMap.member||e.roleInfo.userType!==e.constMap.member?n("Button",{on:{click:function(n){n.stopPropagation(),e.deleteMember(t)}}},[e._v("\n              删除\n            ")]):e._e()],1)])}))]):e._e()]),n("Modal",{attrs:{closable:!1,"mask-closable":!1,title:"请输入团队名称"},on:{"on-ok":e.saveTeamEditing},model:{value:e.editing.show,callback:function(t){e.$set(e.editing,"show",t)},expression:"editing.show"}},[n("Input",{ref:"editingInput",on:{"on-enter":e.saveTeamEditing},model:{value:e.editing.title,callback:function(t){e.$set(e.editing,"title",t)},expression:"editing.title"}})],1),n("Modal",{attrs:{closable:!1,"mask-closable":!1,title:"添加成员"},model:{value:e.addInfo.show,callback:function(t){e.$set(e.addInfo,"show",t)},expression:"addInfo.show"}},[e._l(e.addInfo.list,function(t,s){return n("div",{key:t.key},[n("Row",{attrs:{type:"flex",align:"middle"}},[n("Col",{staticClass:"member-add-col",attrs:{span:"2"}},[e._v("\n          #"+e._s(s+1)+"\n        ")]),n("Col",{staticClass:"member-add-col",attrs:{span:"10"}},[n("Select",{attrs:{filterable:""},model:{value:t.id,callback:function(n){e.$set(t,"id",n)},expression:"item.id"}},e._l(e.readyList,function(t){return n("Option",{key:t.id,attrs:{value:t.id}},[n("div",{staticClass:"option-content"},[n("img",{staticClass:"option-avatar",attrs:{src:t.avatar?e.$avatarUrl.replace("avatarID",t.avatar):"@/assets/logo.png",alt:"用户头像"}}),e._v("\n                "+e._s(t.name)+"\n              ")])])}))],1),n("Col",{staticClass:"member-add-col",attrs:{span:"6"}},[n("Select",{model:{value:t.userType,callback:function(n){e.$set(t,"userType",n)},expression:"item.userType"}},e._l(e.userTypeList,function(t,s){return n("Option",{key:s,attrs:{value:t.code}},[e._v("\n                "+e._s(t.name)+"\n              ")])}))],1),n("Col",{staticClass:"member-add-col",attrs:{span:"3"}},[n("Button",{attrs:{type:"primary"},on:{click:function(t){t.stopPropagation(),e.addMember(s+1)}}},[e._v("增加")])],1),e.addInfo.list.length>1?n("Col",{staticClass:"member-add-col",attrs:{span:"3"}},[n("Button",{attrs:{type:"default"},on:{click:function(t){t.stopPropagation(),e.deleteAddMember(s)}}},[e._v("删除")])],1):e._e()],1)],1)}),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.clearAddInfo(t)}}},[e._v("取消")]),n("Button",{attrs:{type:"primary"},on:{click:function(t){return t.stopPropagation(),e.confirmAddMember(t)}}},[e._v("确定")])],1)],2)],1)},v=[],g=(n("55dd"),n("8afe")),y=n("b05c"),b=n("c64e"),C=n.n(b),w={data:function(){return{teamList:[],currentTeam:{id:0,name:"",list:[]},turnToTeam:0,editing:{title:"",rangeType:0,type:"",show:!1},memberList:[],userTypeList:[],addInfo:{list:[],show:!1},constMap:{admin:0,manager:1,member:2},fold:{personal:!1,company:!1}}},computed:{readyList:function(){var e={};this.addInfo.list.forEach(function(t){e[t.id]=1}),this.currentTeam.list.forEach(function(t){e[t.id]=1});var t=this.memberList.filter(function(t){return!e[t.id]});return t},userInfo:function(){var e=this;return this.currentTeam.list.find(function(t){return e.$store.state.user.userInfo.id===t.id})||{}},roleInfo:function(){var e=this;return this.memberList.find(function(t){return e.$store.state.user.userInfo.id===t.id})||{}}},mounted:function(){this.refreshPage()},methods:{refreshPage:function(){this.clearPage(),this.getMemberList(),this.getTeamList(),this.getUserType()},clearPage:function(){this.memberList=[],this.teamList=[],this.currentTeam={id:0,name:"",list:[]},this.userTypeList=[]},getUserType:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(y["getUserType"])().then(function(e){e.response.success&&(t.userTypeList=e.data)});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getMemberList:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["default"].getMemberList();case 2:t=e.sent,t&&(this.memberList=t);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getTeamList:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,s,r,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=c["default"].getTeamList({rangeType:1}),n=c["default"].getTeamList({rangeType:2}),e.next=4,t;case 4:return s=e.sent,e.next=7,n;case 7:r=e.sent,this.teamList=Object(g["a"])(s).concat(Object(g["a"])(r)),this.teamList&&(i=this.turnToTeam||(this.teamList.length?this.teamList[0].id:0),i&&(this.lookAtTeam(i),this.turnToTeam=0));case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getTeamMemberList:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n={orgId:t},e.next=3,c["default"].getTeamMembers(n);case 3:s=e.sent,s&&(s.sort(function(e,t){return e.userType>t.userType}),this.currentTeam.list=s);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),lookAtTeam:function(e){var t=this.teamList.find(function(t){return t.id===e});!t&&this.teamList.length&&(t=this.teamList[0]),t&&(this.currentTeam.id=t.id,this.currentTeam.name=t.name,this.currentTeam.list=[],this.getTeamMemberList(this.currentTeam.id))},showTeamEditing:function(e){var t=this;this.editing.type=e,this.editing.title="new"===e?"":this.currentTeam.name,this.editing.show=!0,this.$nextTick(function(){t.$refs.editingInput.focus()})},saveTeamEditing:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={name:this.editing.title},"edit"===this.editing.type?t.id=this.currentTeam.id:t.rangeType=this.editing.rangeType,e.next=4,c["default"].saveTeamEditing(t);case 4:n=e.sent,n?(this.turnToTeam=n,this.refreshPage(),this.editing.show=!1):this.$Message.error("操作失败：网络请求失败");case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),tryAddTeam:function(e){this.editing.rangeType=e,this.showTeamEditing("new")},editTeam:function(e){this.showTeamEditing("edit")},tryRemoveTeam:function(){var e="解散团队后团队项目将会移动到公司公共区，确定解散团队".concat(this.currentTeam.name||"","吗?");this.$confirm(e,this.removeTeam)},removeTeam:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["default"].removeTeam({ids:[this.currentTeam.id]});case 2:t=e.sent,t?(this.$Message.success("删除成功"),this.refreshPage()):this.$Message.error("删除失败");case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),addMember:function(e){var t={id:0,userType:2,key:C()()};e||(e=0,this.addInfo.list=[],this.addInfo.show=!0),this.addInfo.list.splice(e,0,t)},confirmAddMember:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,s,r,i,a,o,u,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(t=[],n=!0,s=!1,r=void 0,e.prev=4,i=this.addInfo.list[Symbol.iterator]();!(n=(a=i.next()).done);n=!0)o=a.value,o.id&&t.push({id:o.id,userType:o.userType});e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](4),s=!0,r=e.t0;case 12:e.prev=12,e.prev=13,n||null==i.return||i.return();case 15:if(e.prev=15,!s){e.next=18;break}throw r;case 18:return e.finish(15);case 19:return e.finish(12);case 20:if(t.length){e.next=23;break}return this.$Message.warning("操作失败：未填写任何有效数据"),e.abrupt("return");case 23:return u={members:t,orgId:this.currentTeam.id},e.next=26,c["default"].addMemberToTeam(u);case 26:l=e.sent,l?(this.lookAtTeam(this.currentTeam.id),this.clearAddInfo()):this.$Message.error("添加失败");case 28:case"end":return e.stop()}},e,this,[[4,8,12,20],[13,,15,19]])}));return function(){return e.apply(this,arguments)}}(),deleteAddMember:function(e){this.addInfo.list.splice(e,1)},clearAddInfo:function(){this.addInfo.list=[],this.addInfo.show=!1},deleteMember:function(e){var t=this;if(e.userType!==this.constMap.member){var n=this.currentTeam.list.filter(function(e){return e.userType===t.constMap.manager});if(n.length<=1){var s="该成员是最后一名管理员，请先转让权限";return this.userInfo.id===e.id&&(s="您是团队最后一名管理员，请先转让权限"),void this.$Message.warning(s)}}var r="确定将".concat(e.name,"从团队").concat(this.currentTeam.name,"中移除吗?");this.userInfo.id===e.id&&(r="确定退出团队".concat(this.currentTeam.name,"吗")),this.$confirm(r,this.confirmDeleteMember,e.id,!0)},confirmDeleteMember:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t,n){var s,r,i,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return s={ids:[t],orgId:this.currentTeam.id},e.next=3,c["default"].removeTeamMember(s);case 3:r=e.sent,r?(n?this.refreshPage():this.lookAtTeam(this.currentTeam.id),i=n?"退出成功":"删除成功",this.$Message.success(i)):(a=n?"退出失败":"删除失败",this.$Message.error(a));case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),changePermission:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,s,r,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t.userType!==this.constMap.member){e.next=6;break}if(n=this.currentTeam.list.filter(function(e){return e.userType===i.constMap.manager}),!(n.length<1)){e.next=6;break}return this.$Message.warning("团队里至少有一个管理员"),this.lookAtTeam(this.currentTeam.id),e.abrupt("return");case 6:return s={ids:[t.id],orgId:this.currentTeam.id,userType:t.userType},e.next=9,c["default"].setMemberPermission(s);case 9:r=e.sent,r?this.$Message.success("修改成功"):this.$Message.error("修改失败"),this.lookAtTeam(this.currentTeam.id);case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}},j=w,I=(n("c911"),Object(d["a"])(j,h,v,!1,null,"6d7bb440",null));I.options.__file="orgnization.vue";var k=I.exports,_=k,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"member-page"},[n("div",{staticClass:"title"},[e._v("成员")]),n("div",{staticClass:"member-list"},[n("div",{staticClass:"member-menu"},[n("div",{staticClass:"member-menu-item"},[n("span",[e._v("排序方式:")]),n("Select",{staticStyle:{width:"100px"},attrs:{size:"small"},model:{value:e.sortInfo.sortType,callback:function(t){e.$set(e.sortInfo,"sortType",t)},expression:"sortInfo.sortType"}},e._l(e.sortOptions,function(t,s){return n("Option",{key:s,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+"\n          ")])})),n("div",{staticClass:"sort-swap",attrs:{title:"逆序"},on:{click:function(t){t.stopPropagation(),e.sortInfo.reverse=-1*e.sortInfo.reverse}}},[n("Icon",{staticClass:"sort-swap-icon",attrs:{type:"md-swap"}})],1)],1),e.isManager?n("div",{staticClass:"member-menu-item"},[n("Button",{staticClass:"member-add-button",attrs:{size:"small",type:"success"},on:{click:function(t){return t.stopPropagation(),e.showInviteDialog(t)}}},[e._v("添加成员")])],1):e._e(),e.isManager?n("div",{staticClass:"member-menu-item"},[n("Tooltip",{attrs:{placement:"top",transfer:!0,content:"给所有未激活用户发送激活邮件"}},[n("Button",{attrs:{size:"small",type:"success"},on:{click:function(t){return t.stopPropagation(),e.sendAllEmail(t)}}},[e._v("发送所有激活邮件")])],1)],1):e._e()]),n("div",{staticClass:"members"},e._l(e.memberList,function(t,s){return n("div",{key:s,class:{member:!0,"member-self":e.userInfo.id===t.id}},[n("div",{staticClass:"user-avatar"},[n("img",{staticClass:"avatar",attrs:{src:t.avatar?e.$avatarUrl.replace("avatarID",t.avatar):"@/assets/logo.png",alt:"用户头像"}}),t.name?n("div",{staticClass:"user-name"},[e._v(e._s(t.name))]):e._e()]),n("div",{staticClass:"user-info"},[n("div",{staticClass:"info-item"},[n("Icon",{staticClass:"info-icon",attrs:{type:"ios-mail"}}),n("span",{staticClass:"info-content"},[e._v(e._s(t.email))])],1),n("div",{staticClass:"info-item"},[n("Icon",{staticClass:"info-icon",attrs:{type:"md-call"}}),n("span",{staticClass:"info-content"},[e._v(e._s(t.phone||"未设置"))])],1),t.state?n("div",{staticClass:"info-item"},[n("Icon",{staticClass:"info-icon un-state",attrs:{type:"md-alert"}}),n("span",{staticClass:"info-content"},[e._v("未认证")])],1):n("div",{staticClass:"info-item"},[n("Icon",{staticClass:"info-icon state",attrs:{type:"md-checkmark"}}),n("span",{staticClass:"info-content"},[e._v("已认证")])],1),t.userType===e.constMap.admin||t.userType===e.constMap.manager?n("div",{staticClass:"info-item"},[n("Icon",{staticClass:"info-icon",attrs:{type:"md-person"}}),n("span",{staticClass:"info-content"},[e._v("管理员")])],1):e._e()]),n("div",{staticClass:"menu"},[e.isManager&&t.id!==e.userInfo.id&&t.userType!==e.constMap.admin?n("Select",{staticStyle:{width:"6rem"},attrs:{transfer:!0,value:t.userType},on:{"on-change":function(n){e.setTobeManager(t,n)}}},e._l(e.userTypeList,function(t,s){return n("Option",{key:s,attrs:{value:t.code}},[e._v("\n              "+e._s(t.name)+"\n            ")])})):e._e(),e.isManager&&t.state?n("Button",{staticClass:"email-authenticate",attrs:{disabled:e.emailSentList.includes(t.id),type:"primary"},on:{click:function(n){n.stopPropagation(),e.emailAuthenticate([t.id])}}},[e._v("\n            激活邮件\n          ")]):e._e(),e.isManager&&t.userType!==e.constMap.admin||e.userInfo.id===t.id?n("Button",{staticClass:"edit-user",attrs:{type:"primary"},on:{click:function(n){n.stopPropagation(),e.editMemberInfo(t)}}},[e._v("\n            编辑\n          ")]):e._e(),e.isManager&&t.userType!==e.constMap.admin&&e.userInfo.id!==t.id?n("Button",{attrs:{type:"default"},on:{click:function(n){n.stopPropagation(),e.deleteMember(t)}}},[e._v("\n            删除\n          ")]):e._e()],1)])}))]),n("Modal",{attrs:{width:e.isLocalNetwork?"640":"440","mask-closable":!1,title:"邀请用户",closable:!1},on:{"on-cancel":e.clearInviteeInfo},model:{value:e.showInvite,callback:function(t){e.showInvite=t},expression:"showInvite"}},[n("div",{on:{keyup:function(t){return("button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter"))&&t.ctrlKey?(t.stopPropagation(),void e.addInvitee()):null}}},[n("Layout",{staticClass:"invite"},[n("Row",{staticClass:"invite-header"},[n("Row",{staticClass:"network-row"},[n("h4",[e._v("请选择系统使用的网络环境")]),n("RadioGroup",{model:{value:e.networkType,callback:function(t){e.networkType=t},expression:"networkType"}},[n("Radio",{attrs:{label:1}},[n("span",[e._v("内网")])]),n("Radio",{attrs:{label:2}},[n("span",[e._v("外网")])])],1),n("p",[e._v("当前共填写"+e._s(e.inviteeList.length)+"人")])],1)],1),n("Row",{staticClass:"invite-body"},[n("div",{ref:"userScroll",staticClass:"invite-scroll"},[e._l(e.inviteeList,function(t,s){return[n("Row",{key:s,staticClass:"user-row",attrs:{type:"flex"}},[n("Col",{staticClass:"user-row-cl"},[n("div",{class:{"un-complete":e.isLocalNetwork&&(t.name||t.phone)&&(!t.name||!t.phone),complete:e.isLocalNetwork&&t.name&&t.phone||e.isInternetNetwork&&t.email}},[e._v("\n                    #"+e._s(s+1)+"\n                  ")])]),e.isInternetNetwork?[n("Col",{staticClass:"user-row-cl"},[n("Input",{staticClass:"invitee__input",attrs:{id:"input__"+s+"__1",placeholder:"请输入电子邮箱"},on:{"on-keyup":e.checkKeyUp},model:{value:t.email,callback:function(n){e.$set(t,"email",n)},expression:"item.email"}})],1)]:[n("Col",{staticClass:"user-row-cl"},[n("Input",{staticClass:"invitee__input",attrs:{id:"input__"+s+"__2",placeholder:"请输入姓名"},on:{"on-keyup":e.checkKeyUp},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"item.name"}})],1),n("Col",{staticClass:"user-row-cl"},[n("Input",{staticClass:"invitee__input",attrs:{id:"input__"+s+"__3",placeholder:"请输入电话号码"},on:{"on-keyup":e.checkKeyUp},model:{value:t.phone,callback:function(n){e.$set(t,"phone",n)},expression:"item.phone"}})],1)],n("Col",{staticClass:"user-row-cl"},[n("Select",{staticStyle:{width:"6rem"},model:{value:t.userType,callback:function(n){e.$set(t,"userType",n)},expression:"item.userType"}},e._l(e.userTypeList,function(t,s){return n("Option",{key:s,attrs:{value:t.code}},[e._v("\n                      "+e._s(t.name)+"\n                    ")])}))],1),n("Col",{staticClass:"user-row-cl"},[n("Tooltip",{attrs:{transfer:!0,placement:"top",content:"Ctrl+Enter"}},[n("Button",{attrs:{type:"primary"},on:{click:function(t){t.stopPropagation(),e.addInvitee(s)}}},[n("Icon",{attrs:{type:"md-add"}})],1)],1)],1),n("Col",{staticClass:"user-row-cl"},[n("Button",{style:{opacity:e.inviteeList.length>1?1:0},attrs:{type:"default"},on:{click:function(t){t.stopPropagation(),e.deleteInvitee(s)}}},[n("Icon",{attrs:{type:"md-remove"}})],1)],1)],2)]})],2)])],1)],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text"},on:{click:e.clearInviteeInfo}},[e._v("取消")]),n("Button",{attrs:{type:"primary"},on:{click:function(t){return t.stopPropagation(),e.submitInviteeInfo(t)}}},[e._v("提交")])],1)]),n("Modal",{directives:[{name:"show",rawName:"v-show",value:!e.editing.rebind.show,expression:"!editing.rebind.show"}],attrs:{closable:!1},model:{value:e.editing.show,callback:function(t){e.$set(e.editing,"show",t)},expression:"editing.show"}},[n("div",{staticClass:"setting-header",attrs:{slot:"header"},slot:"header"},[e._v("\n      编辑资料\n    ")]),n("div",{staticClass:"setting-footer",attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.clearEditingInfo(t)}}},[e._v("取消")]),n("Button",{attrs:{type:"primary"},on:{click:function(t){return t.stopPropagation(),e.saveEditingInfo(t)}}},[e._v("确定")])],1),n("div",{staticClass:"setting-content"},[n("Form",{attrs:{model:e.editing.info,"label-width":80}},[e.editing.info.state?e._e():n("FormItem",{staticClass:"form-item",attrs:{label:"头像"}},[n("Row",{staticClass:"form-row",attrs:{type:"flex"}},[n("Col",{staticClass:"form-col",attrs:{span:e.grid.left}},[e.editing.info.avatar?n("img",{staticClass:"setting-avatar",attrs:{src:e.$avatarUrl.replace("avatarID",e.editing.info.avatar),alt:"用户头像"}}):n("div",{staticClass:"avatar-bomb",on:{click:function(t){return t.stopPropagation(),e.selectImage(t)}}},[e._v("\n                  点击上传头像\n                ")]),n("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"avatarInput",attrs:{type:"file",accept:"image/*",name:"avatarInput",id:"avatarInput"},on:{change:e.uploadImage}})]),n("Col",{attrs:{span:e.grid.right}})],1)],1),e.editing.info.state?e._e():n("FormItem",{attrs:{label:"姓名"}},[n("Row",{staticClass:"form-row",attrs:{type:"flex"}},[n("Col",{attrs:{span:e.grid.left}},[n("Input",{attrs:{placeholder:"请输入姓名"},model:{value:e.editing.info.name,callback:function(t){e.$set(e.editing.info,"name",t)},expression:"editing.info.name"}})],1),n("Col",{attrs:{span:e.grid.right}})],1)],1),e.isLocalNetwork||!e.editing.info.state?n("FormItem",{attrs:{label:"手机号"}},[n("Row",{attrs:{type:"flex"}},[n("Col",{attrs:{span:e.grid.left}},[n("Input",{attrs:{disabled:e.isInternetNetwork&&!e.editing.info.state},model:{value:e.editing.info.phone,callback:function(t){e.$set(e.editing.info,"phone",t)},expression:"editing.info.phone"}})],1),n("Col",{staticClass:"form-col",attrs:{span:e.grid.right}},[e.isInternetNetwork&&!e.editing.info.state?n("Button",{staticClass:"rebind-button",attrs:{type:"primary",size:"small"},on:{click:function(t){t.stopPropagation(),e.rebind("phone")}}},[e._v("\n                重新绑定手机号\n              ")]):e._e()],1)],1)],1):e._e(),e.isInternetNetwork?n("FormItem",{attrs:{label:"邮箱"}},[n("Row",{attrs:{type:"flex"}},[n("Col",{attrs:{span:e.grid.left}},[n("Input",{attrs:{disabled:!e.editing.info.state},model:{value:e.editing.info.email,callback:function(t){e.$set(e.editing.info,"email",t)},expression:"editing.info.email"}})],1),n("Col",{staticClass:"form-col",attrs:{span:e.grid.right}},[e.editing.info.state?e._e():n("Button",{staticClass:"rebind-button",attrs:{type:"primary",size:"small"},on:{click:function(t){t.stopPropagation(),e.rebind("email")}}},[e._v("\n                重新绑定邮箱\n              ")])],1)],1)],1):e._e(),e.isManager&&e.editing.info.id!==e.userInfo.id&&e.editing.info.userType!==e.constMap.admin?n("FormItem",{attrs:{label:"权限"}},[n("Col",{attrs:{span:e.grid.left}},[n("Select",{staticStyle:{width:"6rem"},attrs:{transfer:!0},model:{value:e.editing.info.userType,callback:function(t){e.$set(e.editing.info,"userType",t)},expression:"editing.info.userType"}},e._l(e.userTypeList,function(t,s){return n("Option",{key:s,attrs:{value:t.code}},[e._v("\n                "+e._s(t.name)+"\n              ")])}))],1)],1):e._e()],1)],1)]),n("Modal",{staticClass:"rebind-modal",attrs:{"mask-closable":!1,closable:!1},model:{value:e.editing.rebind.show,callback:function(t){e.$set(e.editing.rebind,"show",t)},expression:"editing.rebind.show"}},[n("div",{staticClass:"rebind-title",attrs:{slot:"header"},slot:"header"},[e._v(e._s("phone"===e.editing.rebind.type?"重新绑定手机号":"重新绑定邮箱"))]),n("div",{staticClass:"rebind-form"},[n("Form",{attrs:{"label-width":100}},[n("FormItem",{attrs:{label:"请输入验证码"}},[n("Row",{attrs:{type:"flex"}},[n("Col",{attrs:{span:e.grid.left}},[n("Input",{ref:"rebindImage",attrs:{placeholder:"请输入图片验证码"},model:{value:e.editing.rebind.imageCode,callback:function(t){e.$set(e.editing.rebind,"imageCode",t)},expression:"editing.rebind.imageCode"}})],1),n("Col",{staticClass:"form-col",attrs:{span:e.grid.right}},[n("img",{staticClass:"image-code",attrs:{src:e.editing.rebind.verifyImage,alt:"验证码"},on:{click:function(t){return t.stopPropagation(),e.getNewVerifyImage(t)}}})])],1)],1),"phone"===e.editing.rebind.type?n("FormItem",{attrs:{label:"请输入新手机号"}},[n("Col",{attrs:{span:e.grid.left}},[n("Input",{key:"rebindPhone",ref:"rebindPhone",attrs:{placeholder:"请输入新手机号"},model:{value:e.editing.rebind.phone,callback:function(t){e.$set(e.editing.rebind,"phone",t)},expression:"editing.rebind.phone"}})],1),n("Col",{attrs:{span:e.grid.right}},[n("Button",{staticClass:"rebind-button",attrs:{type:"primary",size:"small",disabled:e.editing.rebind.frozen},on:{click:function(t){return t.stopPropagation(),e.getVerifyCode(t)}}},[e._v("\n              获取短信验证码\n            ")])],1)],1):n("FormItem",{attrs:{label:"请输入新邮箱"}},[n("Col",{attrs:{span:e.grid.left}},[n("Input",{key:"rebindEmail",ref:"rebindEmail",attrs:{placeholder:"请输入新邮箱账号"},model:{value:e.editing.rebind.phone,callback:function(t){e.$set(e.editing.rebind,"phone",t)},expression:"editing.rebind.phone"}})],1),n("Col",{attrs:{span:e.grid.right}},[n("Button",{staticClass:"rebind-button",attrs:{type:"primary",size:"small",disabled:e.editing.rebind.frozen},on:{click:function(t){return t.stopPropagation(),e.getVerifyCode(t)}}},[e._v("\n              获取短信验证码\n            ")])],1)],1),n("FormItem",{attrs:{label:"请输入短信验证码"}},[n("Row",{attrs:{type:"flex"}},[n("Col",{attrs:{span:e.grid.left}},[n("Input",{ref:"rebindCode",attrs:{placeholder:"请输入验证码"},model:{value:e.editing.rebind.verifyCode,callback:function(t){e.$set(e.editing.rebind,"verifyCode",t)},expression:"editing.rebind.verifyCode"}})],1),n("Col",{attrs:{span:e.grid.right}})],1)],1)],1)],1),n("div",{staticClass:"setting-footer",attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text"},on:{click:function(t){t.stopPropagation(),e.editing.rebind.show=!1}}},[e._v("取消")]),n("Button",{attrs:{type:"primary"},on:{click:function(t){return t.stopPropagation(),e.saveRebind(t)}}},[e._v("确定")])],1)])],1)},x=[],P=n("fab3"),M=P["a"],L=(n("6b97"),Object(d["a"])(M,T,x,!1,null,"6383a718",null));L.options.__file="member.vue";var $=L.exports,D=$,R=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"manage-custom-component-page"},[n("div",{staticClass:"title"},[e._v("自定义组件管理\n    "),n("div",{staticClass:"manage-custom-component-tool"},[n("Button",{attrs:{type:"default",shape:"circle",icon:"md-add"},on:{click:e.addCustomComponent}},[e._v("添加自定义组件")])],1)]),n("Layout",[n("Sider",{style:"height: "+e.areaHeight+"px; overflow-y: auto;",attrs:{"hide-trigger":"",width:247}},[e.companies&&e.companies[0]?n("Menu",{attrs:{theme:"light","active-name":e.companies[0].id,"open-names":["company","org","project"]},on:{"on-select":e.selectTeam}},[n("Submenu",{attrs:{name:"company"}},[n("template",{slot:"title"},[n("Icon",{attrs:{type:"ios-people"}}),e._v("\n            当前公司\n          ")],1),e.companies&&e.companies[0]?n("MenuItem",{attrs:{name:e.companies[0].id}},[e._v(e._s(e.companies[0].name))]):e._e()],2),n("Submenu",{attrs:{name:"org"}},[n("template",{slot:"title"},[n("Icon",{attrs:{type:"md-people"}}),e._v("\n            团队\n          ")],1),e._l(e.orgs,function(t,s){return n("MenuItem",{key:s,attrs:{name:"2-"+t.id}},[e._v(e._s(t.name))])})],2),n("Submenu",{attrs:{name:"project"}},[n("template",{slot:"title"},[n("Icon",{attrs:{type:"md-clipboard"}}),e._v("\n            项目\n          ")],1),e._l(e.project,function(t,s){return n("MenuItem",{key:s,attrs:{name:"3-"+t.id}},[e._v(e._s(t.name))])})],2)],1):e._e()],1),n("Layout",[n("Content",{style:"height: "+e.areaHeight+"px; overflow-y: auto;"},[n("div",{staticClass:"manage-custom-component-table"},[n("Row",{staticClass:"manage-custom-component-title",attrs:{gutter:16}},[n("Col",{attrs:{span:e.rowColsMap.index}},[e._v("序号")]),n("Col",{attrs:{span:e.rowColsMap.code}},[e._v("Code")]),n("Col",{attrs:{span:e.rowColsMap.name}},[e._v("名称")]),n("Col",{attrs:{span:e.rowColsMap.description}},[e._v("描述")]),n("Col",{attrs:{span:e.rowColsMap.inputType}},[e._v("输入方式")]),n("Col",{attrs:{span:e.rowColsMap.menu}},[e._v("操作")])],1),n("div",{staticClass:"manage-custom-component-scoll"},e._l(e.componentListCustom,function(t,s){return n("Row",{key:s,staticClass:"manage-custom-component-item",attrs:{gutter:10}},[n("Col",{staticClass:"cindex",attrs:{span:e.rowColsMap.index}},[e._v(e._s(s+1))]),n("Col",{staticClass:"cindex",attrs:{span:e.rowColsMap.code}},[e._v(e._s(t.code||" "))]),n("Col",{staticStyle:{"font-weight":"600"},attrs:{span:e.rowColsMap.name}},[n("span",{staticStyle:{cursor:"pointer"},on:{click:function(n){e.editCustomComponent(t,s)}}},[e._v(e._s(t.name||" "))])]),n("Col",{attrs:{span:e.rowColsMap.description}},[e._v(e._s(t.remarks||" "))]),n("Col",{attrs:{span:e.rowColsMap.inputType}},[n("span",{staticClass:"component-name-border"},[e._v(e._s(t.inputType))])]),n("Col",{attrs:{span:e.rowColsMap.menu}},[n("Button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:function(n){e.editCustomComponent(t,s)}}},[e._v("配置")]),n("Button",{directives:[{name:"show",rawName:"v-show",value:"树形"===t.inputType,expression:"item.inputType === '树形'"}],staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:function(n){e.dataCustomComponent(t,s)}}},[e._v("数据")]),n("Poptip",{staticStyle:{"text-align":"left"},attrs:{confirm:"",placement:"bottom",title:"您确认删除这个自定义组件吗？"},on:{"on-ok":function(n){e.deleteCustomComponent(t,s)}}},[n("Button",{attrs:{type:"error"}},[e._v("删除")])],1)],1)],1)}))],1)])],1)],1),n("customComponentEdit",{attrs:{editItem:e.editItem,judgeComponent:e.judgeComponent,org:e.filterId[0],team:e.filterId[1],teamList:e.orgs,projectList:e.project},on:{updateList:e.updateCustomComponentList},model:{value:e.showCustomComponent,callback:function(t){e.showCustomComponent=t},expression:"showCustomComponent"}})],1)},O=[],E=(n("28a5"),n("aa15")),U=n("24d2"),S=n("db54"),A={name:"manage-custom-component-page",components:{customComponentEdit:S["a"]},computed:{componentList:function(){return this.$store.state.component.list},componentQuestion:function(){return this.$store.state.component.question},componentOptions:function(){return this.$store.state.component.options},companyList:function(){return this.$store.state.user.companyList},currentCompany:function(){return this.$store.state.user.currentCompany}},data:function(){return{showCustomComponent:!1,editItem:null,rowColsMap:{index:2,code:2,name:4,description:5,inputType:4,menu:7},dataItem:null,companies:[],orgs:[],filterId:[null,null],componentListCustom:[],relationComponentAOList:[],judgeComponent:{},project:[],areaHeight:window.innerHeight-300}},created:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([c["default"].getTeamList({rangeType:2}),U["default"].getProjectList({orgId:"",rangeType:1,type:1})]);case 2:return t=e.sent,this.companies=this.companyList,this.filterId[0]=this.currentCompany,this.orgs=t[0],this.project=t[1],e.next=9,this.updateCustomComponentList();case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),methods:{selectTeam:function(e){this.filterId[0]===e?this.filterId[1]=null:this.filterId[1]=e,this.updateCustomComponentList()},editCustomComponent:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return Object(E["clearCompontentCache"])(),e.next=3,Object(E["getCompontentCache"])(t.id);case 3:this.editItem=e.sent,this.showCustomComponent=!0;case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),dataCustomComponent:function(e){this.dataItem=e,this.$router.push({name:"DataComponent",query:{id:e.id}})},updateCustomComponentList:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={sourceId:this.filterId[0],sourceType:1},n=[],this.filterId[1]?(s={sourceId:this.filterId[1].split("-")[1],sourceType:parseInt(this.filterId[1].split("-")[0])},n.push(s)):n.push(t),e.next=5,Object(E["getSimpleCustomList"])({relationComponentAOList:n});case 5:this.componentListCustom=e.sent;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),addCustomComponent:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.editItem=null,Object(E["clearCompontentCache"])(),e.next=4,Object(E["getCompontentCache"])(this.componentQuestion["judge"].id);case 4:this.judgeComponent=e.sent,this.showCustomComponent=!0;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),deleteCustomComponent:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(E["delCompontent"])(t.id);case 2:if(!e.sent){e.next=7;break}this.$Message.success("删除成功"),this.updateCustomComponentList(),e.next=8;break;case 7:this.$Modal.error({title:"错误",content:"<p>因自定义组件正在被使用，删除该自定义组件失败</p>",loading:!0,cancelText:"",onOk:function(){setTimeout(function(){n.$Modal.remove()},1e3)}});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}},B=A,N=(n("d15c"),Object(d["a"])(B,R,O,!1,null,null,null));N.options.__file="manage.vue";var z=N.exports,F=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"project-page"},[n("div",{staticClass:"title"},[e._v("项目")]),n("div",{staticClass:"page-content"},[n("div",{staticClass:"menu-list"},[n("div",{class:{"menu-item":!0,"choose-menu":e.menuSelected.rangeType===e.constMap.personal},on:{click:function(t){t.stopPropagation(),e.selectMenu(1)}}},[e._v("\n        我的项目\n      ")]),n("div",{class:{"menu-item":!0,"choose-menu":e.menuSelected.rangeType===e.constMap.company},on:{click:function(t){t.stopPropagation(),e.selectMenu(2)}}},[e._v("\n        公司项目\n      ")]),n("div",{staticClass:"menu-items"},[n("div",{staticClass:"menu-item-title"},[n("div",{staticClass:"devide-line"}),e.teamList.length?n("div",{staticClass:"title-text"},[n("span",[e._v("团队项目")])]):e._e(),n("div",{staticClass:"devide-line"})]),e._l(e.teamList,function(t){return t.companyId?n("div",{key:t.id,class:{"menu-team-item":!0,"choose-menu":e.menuSelected.orgId===t.id},on:{click:function(n){n.stopPropagation(),e.selectMenu(3,t.id)}}},[n("Icon",{staticClass:"team-icon-company",attrs:{title:"公司团队",type:"md-people"}}),n("span",{staticClass:"team-name"},[e._v(e._s(t.name))])],1):e._e()}),e._l(e.teamList,function(t){return t.companyId?e._e():n("div",{key:t.id,class:{"menu-team-item":!0,"choose-menu":e.menuSelected.orgId===t.id},on:{click:function(n){n.stopPropagation(),e.selectMenu(3,t.id)}}},[n("Icon",{staticClass:"team-icon-personal",attrs:{title:"个人团队",type:"md-people"}}),n("span",{staticClass:"team-name"},[e._v(e._s(t.name))])],1)})],2)]),n("div",{staticClass:"project-list"},[n("Button",{staticClass:"project-add",attrs:{icon:"md-add"},on:{click:function(t){return t.stopPropagation(),e.tryAddProject(t)}}}),e._l(e.projectList,function(t,s){return n("div",{key:s,class:{project:!0,"detail-project":e.projectDetail.project===t},on:{click:function(n){n.stopPropagation(),e.openProject(t.id)},mouseleave:e.hideProjectMenu}},[n("div",{staticClass:"project-menu"},[n("div",{staticClass:"project-menu-button"},[n("span",{staticClass:"project-menu-icon",on:{click:function(e){e.stopPropagation()},mouseenter:function(n){e.showProjectMenu(t)}}},[n("Icon",{staticClass:"menu-icon",attrs:{type:"md-menu"}})],1)]),n("div",{directives:[{name:"show",rawName:"v-show",value:e.projectMenu.showId===t.id,expression:"projectMenu.showId === project.id"}],staticClass:"project-menu-items",on:{mouseleave:e.hideProjectMenu}},e._l(e.projectMenu.menuItems,function(s,r){return n("div",{key:r,staticClass:"project-menu-item",on:{click:function(n){n.stopPropagation(),e.clickProjectMenu(s,t)}}},[e._v("\n              "+e._s(s.title)+"\n            ")])}))]),n("div",{staticClass:"project-icon"},e._l(7,function(e,t){return n("div",{key:t,staticClass:"project-abstract"})})),n("div",{staticClass:"project-name",attrs:{title:t.name}},[e._v("\n          "+e._s(t.name)+"\n        ")])])})],2),n("div",{directives:[{name:"show",rawName:"v-show",value:e.projectDetail.show,expression:"projectDetail.show"}],staticClass:"project-detail"},[n("div",{staticClass:"detail-menu"},[n("Icon",{staticClass:"detail-menu-icon",attrs:{type:"md-close"},on:{click:function(t){return t.stopPropagation(),e.hideProjectDetail(t)}}})],1),n("div",{staticClass:"detail-item base-info"},[e._m(0),n("div",{staticClass:"base-info-content"},[n("div",{staticClass:"base-info-item"},[n("div",{staticClass:"info-item-title"},[e._v("项目名称")]),n("Input",{on:{"on-change":e.changeProjectInfo,"on-blur":e.saveProjectInfo,"on-enter":e.saveProjectInfo},model:{value:e.projectDetail.project.name,callback:function(t){e.$set(e.projectDetail.project,"name",t)},expression:"projectDetail.project.name"}})],1),n("div",{staticClass:"base-info-item"},[n("div",{staticClass:"info-item-title"},[e._v("显示名称")]),n("Input",{on:{"on-change":e.changeProjectInfo,"on-blur":e.saveProjectInfo,"on-enter":e.saveProjectInfo},model:{value:e.projectDetail.project.showName,callback:function(t){e.$set(e.projectDetail.project,"showName",t)},expression:"projectDetail.project.showName"}})],1),n("div",{staticClass:"base-info-item"},[n("div",{staticClass:"info-item-title"},[e._v("英文名称")]),n("Input",{on:{"on-change":e.changeProjectInfo,"on-blur":e.saveProjectInfo,"on-enter":e.saveProjectInfo},model:{value:e.projectDetail.project.enName,callback:function(t){e.$set(e.projectDetail.project,"enName",t)},expression:"projectDetail.project.enName"}})],1),n("div",{staticClass:"base-info-item"},[n("div",{staticClass:"info-item-title"},[e._v("项目描述")]),n("Input",{attrs:{autosize:{minRows:5},type:"textarea"},on:{"on-change":e.changeProjectInfo,"on-keyup":function(t){return("button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter"))&&t.ctrlKey?e.saveProjectInfo(t):null},"on-blur":e.saveProjectInfo},model:{value:e.projectDetail.project.remarks,callback:function(t){e.$set(e.projectDetail.project,"remarks",t)},expression:"projectDetail.project.remarks"}})],1)])]),e.projectDetail.project.companyId||e.userInfo.userType===e.constMap.manager?n("div",{staticClass:"detail-item detail-company"},[e._m(1),n("div",{staticClass:"detail-company-content"},[e.projectDetail.project.companyId?[n("div",{staticClass:"company-name"},[e._v("\n              "+e._s(e.projectDetail.project.companyName)+"\n            ")])]:[n("Button",{attrs:{type:"default"},on:{click:e.setToCompany}},[e._v("移动到当前公司")]),n("div",{staticClass:"notice"},[e._v("注意: 个人项目移动到公司为不可逆操作，请谨慎。目前暂不支持公司项目转让。")])]],2)]):e._e(),n("div",{staticClass:"detail-item detail-team"},[e._m(2),n("div",{staticClass:"detail-team-content"},[e.projectDetail.project.orgId?n("div",{staticClass:"team-abstract"},[n("span",{staticClass:"team-icon"},[n("Icon",{attrs:{type:"md-people"}})],1),n("span",{staticClass:"team-name"},[e._v("\n              "+e._s(e.projectDetail.project.orgName)+"\n            ")])]):e._e(),n("Button",{staticClass:"detail-team-set",on:{click:function(t){return t.stopPropagation(),e.setTeam(t)}}},[e.projectDetail.project.orgId?n("span",[e._v("更改")]):n("span",[e._v("设置")])])],1)]),n("div",{staticClass:"detail-item detail-members"},[e._m(3),n("div",{staticClass:"detail-members-content"},[n("div",{staticClass:"detail-member add-member"},[n("div",{staticClass:"add-member-button",on:{click:function(t){t.stopPropagation(),e.addProjectMember()}}},[n("Icon",{attrs:{type:"md-add"}})],1)]),e._l(e.projectDetail.memberList,function(t){return n("div",{key:t.id,staticClass:"detail-member"},[n("div",{staticClass:"avatar",attrs:{title:t.name}},[n("img",{staticClass:"avatar-img",attrs:{src:t.avatar?e.$avatarUrl.replace("avatarID",t.avatar):"@/assets/logo.png",alt:"用户头像"}}),n("div",{staticClass:"avatar-name"},[e._v(e._s(t.name))])]),n("div",{staticClass:"user-info"},[t.userType===e.constMap.manager?n("div",{staticClass:"info-item"},[n("Icon",{staticClass:"info-icon",attrs:{type:"md-person"}}),n("span",{staticClass:"info-content"},[e._v("管理员")])],1):e._e()]),n("div",{staticClass:"member-menu"},[e.userInfo.userType===e.constMap.member&&e.roleInfo.userType===e.constMap.member||e.userInfo.id===t.id?e._e():n("Select",{staticStyle:{width:"6rem"},attrs:{transfer:!0},on:{"on-change":function(n){e.changePermission(t)}},model:{value:t.userType,callback:function(n){e.$set(t,"userType",n)},expression:"member.userType"}},e._l(e.userTypeList,function(t,s){return n("Option",{key:s,attrs:{value:t.code}},[e._v("\n                  "+e._s(t.name)+"\n                ")])})),n("Button",{attrs:{type:"default"},on:{click:function(n){n.stopPropagation(),e.tryRemoveProjectmember(t)}}},[e.userInfo.id===t.id?n("span",[e._v("退出")]):e._e(),e.userInfo.userType===e.constMap.member&&e.roleInfo.userType===e.constMap.member||e.userInfo.id===t.id?e._e():n("span",[e._v("删除")])])],1)])})],2)])])]),n("Modal",{attrs:{title:"请输入项目标题"},model:{value:e.newProject.show,callback:function(t){e.$set(e.newProject,"show",t)},expression:"newProject.show"}},[n("div",{staticClass:"new-project"},[n("div",{staticClass:"new-project-input"},[n("Input",{ref:"newProjectInput",attrs:{placeholder:"请输入项目标题"},on:{"on-enter":e.confirmAddProject},model:{value:e.newProject.info.name,callback:function(t){e.$set(e.newProject.info,"name",t)},expression:"newProject.info.name"}})],1),n("div",{staticClass:"check-enter"},[n("Checkbox",{model:{value:e.newProject.enter,callback:function(t){e.$set(e.newProject,"enter",t)},expression:"newProject.enter"}},[e._v("创建后进入项目编辑页面")])],1)]),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.clearNewProjectInfo(t)}}},[e._v("取消")]),n("Button",{attrs:{type:"primary"},on:{click:function(t){return t.stopPropagation(),e.confirmAddProject(t)}}},[e._v("确定")])],1)]),n("Modal",{attrs:{title:"设置项目团队","mask-closable":!1,width:400,closable:!1,transfer:!0},model:{value:e.projectDetail.teamEditShow,callback:function(t){e.$set(e.projectDetail,"teamEditShow",t)},expression:"projectDetail.teamEditShow"}},[n("div",{staticClass:"project-team-set"},[n("Row",{staticClass:"project-team-choose",attrs:{type:"flex",align:"middle",justify:"center"}},[n("Col",{attrs:{span:6}},[n("span",[e._v("\n          请选择团队\n          ")])]),n("Col",{attrs:{span:6}},[n("Select",{on:{"on-change":e.getTeamMembers},model:{value:e.projectDetail.teamEditInfo.orgId,callback:function(t){e.$set(e.projectDetail.teamEditInfo,"orgId",t)},expression:"projectDetail.teamEditInfo.orgId"}},e._l(e.projectDetail.teamEditInfo.readyTeam,function(e,t){return n("Option",{key:t,attrs:{value:e.id,label:e.name}})}))],1)],1),n("div",{staticClass:"project-member-add"},e._l(e.projectDetail.teamEditInfo.members,function(t,s){return n("Row",{key:s,staticClass:"member-row",attrs:{type:"flex",align:"middle",justify:"center"}},[n("Col",{staticClass:"member-col",attrs:{span:14}},[n("img",{staticClass:"member-add-avatar",attrs:{alt:"头像",src:t.avatar?e.$avatarUrl.replace("avatarID",t.avatar):"@/assets/logo.png"}}),e._v("\n              "+e._s(t.name)+"\n          ")]),n("Col",{staticClass:"member-col",attrs:{span:2}},[n("Checkbox",{attrs:{disabled:t.id===e.userInfo.id},model:{value:t.inProject,callback:function(n){e.$set(t,"inProject",n)},expression:"member.inProject"}})],1),n("Col",{staticClass:"member-col",attrs:{span:8}},[t.inProject?n("Select",{staticStyle:{width:"6rem"},attrs:{size:"small",disabled:t.id===e.userInfo.id,transfer:!0},model:{value:t.userType,callback:function(n){e.$set(t,"userType",n)},expression:"member.userType"}},e._l(e.userTypeList,function(t,s){return n("Option",{key:s,attrs:{value:t.code}},[e._v("\n                "+e._s(t.name)+"\n              ")])})):e._e()],1)],1)}))],1),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.clearTeamEditInfo(t)}}},[e._v("取消")]),n("Button",{attrs:{type:"primary"},on:{click:function(t){return t.stopPropagation(),e.setTeamInfo(t)}}},[e._v("确定")])],1)]),n("Modal",{attrs:{title:"添加项目成员",width:720,closable:!1,"mask-closable":!1,transfer:!0},model:{value:e.projectDetail.addShow,callback:function(t){e.$set(e.projectDetail,"addShow",t)},expression:"projectDetail.addShow"}},[n("div",{staticClass:"project-member-add"},e._l(this.projectDetail.addList,function(t,s){return n("Row",{key:t.key,staticClass:"member-row",attrs:{type:"flex",align:"middle"}},[n("Col",{staticClass:"member-col",attrs:{span:2}},[e._v("\n        #"+e._s(s+1)+"\n        ")]),n("Col",{staticClass:"member-col",attrs:{span:12}},[n("img",{staticClass:"member-add-avatar",attrs:{src:t.info.avatar?e.$avatarUrl.replace("avatarID",t.info.avatar):"@/assets/logo.png"}}),n("Select",{ref:"memberSelect",refInFor:!0,attrs:{"remote-method":e.remoteGetReadyList,loading:e.projectDetail.loading,placeholder:"请输入手机号",transfer:!0,title:t.info.name||"",remote:"",filterable:"",clearable:""},on:{"on-open-change":function(n){e.changeOpen(n,s,t)},"on-change":function(n){e.setAddMemberInfo(t)}},model:{value:t.id,callback:function(n){e.$set(t,"id",n)},expression:"member.id"}},e._l(e.projectDetail.readyList,function(t){return n("Option",{key:t.id,staticClass:"member-option",attrs:{value:t.id,label:t.name}},[n("img",{staticClass:"member-option-avatar",attrs:{src:t.avatar?e.$avatarUrl.replace("avatarID",t.avatar):"@/assets/logo.png"}}),n("span",{staticClass:"member-option-name",attrs:{title:t.name}},[e._v("\n                  "+e._s(t.name)+"\n                ")]),e._v("\n                "+e._s(t.phone)+"\n            ")])}))],1),n("Col",{staticClass:"member-col",attrs:{span:6}},[n("Select",{staticStyle:{width:"6rem"},attrs:{transfer:!0},model:{value:t.userType,callback:function(n){e.$set(t,"userType",n)},expression:"member.userType"}},e._l(e.userTypeList,function(t,s){return n("Option",{key:s,attrs:{value:t.code}},[e._v("\n              "+e._s(t.name)+"\n            ")])}))],1),n("Col",{staticClass:"member-col",attrs:{span:2}},[n("Button",{attrs:{type:"primary",size:"small"},on:{click:function(t){t.stopPropagation(),e.addProjectMember(s+1)}}},[e._v("添加")])],1),n("Col",{staticClass:"member-col",attrs:{span:2}},[e.projectDetail.addList.length>1?n("Button",{attrs:{type:"default",size:"small"},on:{click:function(t){t.stopPropagation(),e.removeAddMember(s)}}},[e._v("\n            删除\n          ")]):e._e()],1)],1)})),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),e.clearMemberAddInfo(t)}}},[e._v("取消")]),n("Button",{attrs:{type:"primary"},on:{click:function(t){return t.stopPropagation(),e.confirmAddMember(t)}}},[e._v("确定")])],1)])],1)},V=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"detail-title"},[n("span",{staticClass:"detail-title-content"},[e._v("基本信息")]),n("div",{staticClass:"detail-title-line"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"detail-title"},[n("span",{staticClass:"detaile-title-content"},[e._v("公司")]),n("div",{staticClass:"detail-title-line"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"detail-title"},[n("span",{staticClass:"detail-title-content"},[e._v("团队")]),n("div",{staticClass:"detail-title-line"})])},function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"detail-title"},[n("span",{staticClass:"detail-title-content"},[e._v("成员")]),n("div",{staticClass:"detail-title-line"})])}],H=(n("2fdb"),n("6762"),n("c93e")),q=(n("f751"),{data:function(){return{teamList:[],userTypeList:[],menuSelected:{rangeType:1,orgId:""},constMap:{personal:1,company:2,team:3,personalTeam:1,companyTeam:2,allTeam:3,admin:0,manager:1,member:2},projectList:[],memberList:[],newProject:{show:!1,enter:!0,info:{name:"",rangeType:"",orgId:"",type:1},addLock:!1},projectMenu:{showId:0,menuItems:[{title:"详情",click:this.showProjectDetail},{title:"删除",click:this.tryDeleteProject}]},projectDetail:{show:!1,project:{},infoChanged:!1,team:{},teamEditShow:!1,teamEditInfo:{readyTeam:[],orgId:"",projectId:0,members:[]},memberList:[],addList:[],readyList:[],addShow:!1,loading:!1,timerIdx:0},turnToProject:0}},computed:{userInfo:function(){var e=this;return this.projectDetail.memberList.find(function(t){return e.$store.state.user.userInfo.id===t.id})||{}},roleInfo:function(){var e=this;return this.memberList.find(function(t){return e.$store.state.user.userInfo.id===t.id})||{}}},mounted:function(){this.refreshPage()},methods:{refreshPage:function(){this.getUserType(),this.getMemberList(),this.getTeamList(),this.selectMenu()},getTeamList:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,s,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=c["default"].getTeamList({rangeType:1}),n=c["default"].getTeamList({rangeType:2}),e.next=4,t;case 4:return s=e.sent,e.next=7,n;case 7:r=e.sent,this.teamList=Object(g["a"])(s).concat(Object(g["a"])(r));case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getTeamMemberList:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n={orgId:t},e.next=3,c["default"].getTeamMembers(n);case 3:return s=e.sent,e.abrupt("return",s);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getUserType:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(y["getUserType"])().then(function(e){e.response.success&&(t.userTypeList=e.data)});case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getMemberList:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,c["default"].getMemberList();case 2:t=e.sent,t&&(this.memberList=t);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),tryAddProject:function(){var e=this;this.newProject.show=!0,this.$nextTick(function(){e.$refs.newProjectInput.focus()})},confirmAddProject:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.newProject.addLock){e.next=3;break}return this.$Message.success("正在保存..."),e.abrupt("return");case 3:return this.newProject.addLock=!0,Object.assign(this.newProject.info,this.menuSelected),e.next=7,U["default"].addProject(this.newProject.info);case 7:t=e.sent,t?(this.$Message.success("添加成功"),this.newProject.enter?this.openProject(t.id):(this.clearNewProjectInfo(),this.selectMenu())):(this.$Message.error("添加失败"),this.$refs.newProjectInput.focus()),this.newProject.addLock=!1;case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),openProject:function(e){this.projectMenu.showId!==e&&this.$router.push({name:"Page",params:{projectId:e}})},tryDeleteProject:function(e){var t="你确定删除项目".concat(e.name,"吗？");this.$confirm(t,this.confirmDeleteProject,e.id)},confirmDeleteProject:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n={ids:[t]},e.next=3,U["default"].deleteProject(n);case 3:s=e.sent,s?this.selectMenu():this.$Message.error("刪除失败");case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),clearNewProjectInfo:function(){this.newProject={show:!1,enter:!0,info:{title:"",rangeType:"",orgId:"",type:1}}},getProjectList:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,s,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=Object(H["a"])({},this.menuSelected,{type:1}),e.next=3,U["default"].getProjectList(t);case 3:n=e.sent,n?(this.projectList=n,s=null,this.turnToProject&&(s=this.projectList.find(function(e){return e.id===r.turnToProject}),this.turnToProject=0),s&&this.showProjectDetail(s)):this.$Message.error("获取项目列表失败");case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),selectMenu:function(e,t){e!==this.menuSelected.rangeType&&this.hideProjectDetail(),void 0!==e&&(this.menuSelected={rangeType:e,orgId:t||""}),this.getProjectList()},showProjectMenu:function(e){this.projectMenu.showId=e.id},hideProjectMenu:function(){this.projectMenu.showId=0},clickProjectMenu:function(e,t){this.hideProjectMenu(),e.click&&e.click(t)},showProjectDetail:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.projectDetail.show=!0,this.projectDetail.project=t,n={projectId:t.id},e.next=5,U["default"].getProjectMembers(n);case 5:s=e.sent,s?this.projectDetail.memberList=s:this.$Message.error("获取成员列表失败");case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),hideProjectDetail:function(){this.projectDetail.show=!1,this.projectDetail.project={}},setMembers:function(e){},setToCompany:function(){var e=this,t="个人项目移动到公司为不可逆操作，确定移动项目到公司吗？";this.$confirm(t,Object(o["a"])(regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,U["default"].setToCompany({projectId:e.projectDetail.project.id});case 2:n=t.sent,n?(e.$Message.success("设置成功"),e.showProjectDetail(e.projectDetail.project)):e.$Message.error("设置失败");case 4:case"end":return t.stop()}},t,this)})))},setTeam:function(){this.projectDetail.teamEditShow=!0,this.projectDetail.teamEditInfo.orgId=this.projectDetail.project.orgId,this.getReadyTeam()},getReadyTeam:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,s,r=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t={projectId:this.projectDetail.project.id},e.next=3,U["default"].getProjectReadyTeamList(t);case 3:n=e.sent,n?this.projectDetail.teamEditInfo.readyTeam=n:this.$Message.error("加载团队列表失败"),s=this.projectDetail.teamEditInfo.readyTeam.find(function(e){return e.id===r.projectDetail.project.orgId}),s&&this.getTeamMembers();case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getTeamMembers:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,s,r,i,a,o,u=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.projectDetail.teamEditInfo.orgId){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,c["default"].getTeamMembers({orgId:this.projectDetail.teamEditInfo.orgId});case 4:if(t=e.sent,!t){e.next=29;break}for(this.projectDetail.teamEditInfo.members=[],n=!0,s=!1,r=void 0,e.prev=10,i=function(){var e=o.value,t={name:e.name,avatar:e.avatar,id:e.id,inProject:!1,userType:2},n=u.projectDetail.memberList.find(function(t){return t.id===e.id});n&&(t.inProject=!0,t.userType=n.userType),u.projectDetail.teamEditInfo.members.push(t)},a=t[Symbol.iterator]();!(n=(o=a.next()).done);n=!0)i();e.next=19;break;case 15:e.prev=15,e.t0=e["catch"](10),s=!0,r=e.t0;case 19:e.prev=19,e.prev=20,n||null==a.return||a.return();case 22:if(e.prev=22,!s){e.next=25;break}throw r;case 25:return e.finish(22);case 26:return e.finish(19);case 27:e.next=30;break;case 29:this.$Message.error("加载团队成员列表失败");case 30:case"end":return e.stop()}},e,this,[[10,15,19,27],[20,,22,26]])}));return function(){return e.apply(this,arguments)}}(),setTeamInfo:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,s,r,i,a,o,c,u;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t={members:[],orgId:this.projectDetail.teamEditInfo.orgId,projectId:this.projectDetail.project.id},n=!0,s=!1,r=void 0,e.prev=4,i=this.projectDetail.teamEditInfo.members[Symbol.iterator]();case 6:if(n=(a=i.next()).done){e.next=15;break}if(o=a.value,o.inProject){e.next=10;break}return e.abrupt("continue",12);case 10:c={id:o.id,userType:o.userType},t.members.push(c);case 12:n=!0,e.next=6;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e["catch"](4),s=!0,r=e.t0;case 21:e.prev=21,e.prev=22,n||null==i.return||i.return();case 24:if(e.prev=24,!s){e.next=27;break}throw r;case 27:return e.finish(24);case 28:return e.finish(21);case 29:return e.next=31,U["default"].setOrgInfo(t);case 31:u=e.sent,u?(this.clearTeamEditInfo(),this.turnToProject=this.projectDetail.project.id,this.getProjectList()):this.$Message.error("设置失败");case 33:case"end":return e.stop()}},e,this,[[4,17,21,29],[22,,24,28]])}));return function(){return e.apply(this,arguments)}}(),clearTeamEditInfo:function(){this.projectDetail.teamEditShow=!1,this.projectDetail.teamEditInfo={readyTeam:[],orgId:"",projectId:0,members:[]}},changeProjectInfo:function(){this.projectDetail.infoChanged=!0},saveProjectInfo:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.projectDetail.infoChanged){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,U["default"].updateProject(this.projectDetail.project);case 4:t=e.sent,t?(this.$Message.success("修改成功"),this.projectDetail.infoChanged=!1):(this.$Message.error("修改内容保存失败"),this.turnToProject=this.projectDetail.project.id,this.getProjectList());case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),addProjectMember:function(e){var t={id:0,userType:this.constMap.member,info:{},key:C()()};this.projectDetail.addShow=!0,e?this.projectDetail.addList.splice(e,0,t):this.projectDetail.addList=[t]},removeAddMember:function(e){this.projectDetail.addList.length>1&&this.projectDetail.addList.splice(e,1)},confirmAddMember:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(){var t,n,s,r,i,a,o,c,u,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(t=[],n=!0,s=!1,r=void 0,e.prev=4,i=this.projectDetail.addList[Symbol.iterator]();!(n=(a=i.next()).done);n=!0)o=a.value,o.id&&(c={id:o.id,userType:o.userType},t.push(c));e.next=12;break;case 8:e.prev=8,e.t0=e["catch"](4),s=!0,r=e.t0;case 12:e.prev=12,e.prev=13,n||null==i.return||i.return();case 15:if(e.prev=15,!s){e.next=18;break}throw r;case 18:return e.finish(15);case 19:return e.finish(12);case 20:if(t.length){e.next=23;break}return this.$Message.warning("未填写任何有效数据"),e.abrupt("return");case 23:return u={projectId:this.projectDetail.project.id,members:t},e.next=26,U["default"].addProjectMembers(u);case 26:l=e.sent,l?(this.$Message.success("添加成功"),this.clearMemberAddInfo()):this.$Message.error("添加失败"),this.showProjectDetail(this.projectDetail.project);case 29:case"end":return e.stop()}},e,this,[[4,8,12,20],[13,,15,19]])}));return function(){return e.apply(this,arguments)}}(),clearMemberAddInfo:function(){this.projectDetail.addShow=!1,this.projectDetail.addList=[]},setAddMemberInfo:function(e){var t=this.projectDetail.readyList.find(function(t){return t.id===e.id});e.info=t||{}},tryRemoveProjectmember:function(e){var t=this,n=e.id===this.userInfo.id;if(e.userType===this.constMap.manager){var s=this.projectDetail.memberList.filter(function(e){return e.userType===t.constMap.manager});if(s.length<=1){var r="该成员是最后项目一名管理员，请先转让权限";return n&&(r="您是项目最后一名管理员，请先转让权限"),this.$Message.warning(r),void this.showProjectDetail(this.projectDetail.project)}}var i="确认将成员".concat(e.name,"移出项目").concat(this.projectDetail.project.name,"吗？");n&&(i="您确认退出项目".concat(this.projectDetail.project.name,"吗")),this.$confirm(i,this.confirmRemoveProjectMember,e.id,n)},confirmRemoveProjectMember:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t,n){var s,r,i,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return s={ids:[t],projectId:this.projectDetail.project.id},e.next=3,U["default"].removeProjectMember(s);case 3:r=e.sent,r?(i=n?"退出成功":"删除成功",this.$Message.success(i),this.showProjectDetail(this.projectDetail.project)):(a=n?"退出失败":"删除失败",this.$Message.error(a),this.turnToProject=this.projectDetail.project.id,this.getProjectList());case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),changeOpen:function(e,t,n){if(e){this.projectDetail.readyList=[];var s=n.info.phone||"";s?this.$refs.memberSelect[t].setQuery(s):this.remoteGetReadyList(s)}},remoteGetReadyList:function(e){var t=this;this.projectDetail.timerIdx&&clearTimeout(this.projectDetail.timerIdx),this.projectDetail.timerIdx=setTimeout(Object(o["a"])(regeneratorRuntime.mark(function n(){var s,r,i,a;return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:return t.projectDetail.timerIdx=0,s={keywords:e},t.projectDetail.loading=!0,n.next=5,U["default"].getUserListByKeyword(s);case 5:r=n.sent,t.projectDetail.loading=!1,r?(i=[],t.projectDetail.memberList.forEach(function(e){return i.push(e.id)}),t.projectDetail.addList.forEach(function(e){return i.push(e.id)}),a=r.filter(function(e){return!i.includes(e.id)}),t.projectDetail.readyList=a):t.$Message.error("获取用户列表失败，可能是网络挂了");case 8:case"end":return n.stop()}},n,this)})),200)},changePermission:function(){var e=Object(o["a"])(regeneratorRuntime.mark(function e(t){var n,s,r,i=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(t.userType!==this.constMap.member){e.next=6;break}if(n=this.projectDetail.memberList.filter(function(e){return e.userType===i.constMap.manager}),!(n.length<1)){e.next=6;break}return this.$Message.warning("团队里至少有一个管理员"),this.showProjectDetail(this.projectDetail.project),e.abrupt("return");case 6:return s={ids:[t.id],projectId:this.projectDetail.project.id,userType:t.userType},e.next=9,U["default"].setMemberPermission(s);case 9:r=e.sent,r?this.$Message.success("修改成功"):this.$Message.error("修改失败");case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}}),K=q,G=(n("e88e"),Object(d["a"])(K,F,V,!1,null,"31eba064",null));G.options.__file="project-board.vue";var Q=G.exports,J=Q,W=n("c508"),Y=n("b2b9"),X={name:"home-page",components:{OrgBoard:f,Orgnization:_,Member:D,CustomComponentManage:z,ProjectBoard:J,NetworkDisk:W["a"],AnswerRecord:Y["default"]},data:function(){return{showItems:[{name:"project",title:"项目",icon:"md-clipboard"},{name:"orgnization",title:"团队",icon:"md-people"},{name:"member",title:"成员",icon:"md-contacts"},{name:"networkDisk",title:"网盘",icon:"md-cloud"},{name:"customComponent",title:"自定义组件管理",icon:"md-cube"}],menuShow:!0}},computed:{showType:function(){return this.$route.query.type||"project"}},watch:{showType:function(){var e=this,t=this.showItems.find(function(t){return t.name===e.showType});t&&this.$setTitle(t.title)}},methods:{setShowType:function(e){this.$router.push({name:"Home",query:{type:e}})},showMenu:function(){this.menuShow=!0},hideMenu:function(){this.menuShow=!1}},created:function(){this.$bus.$on("show-home-menu",this.showMenu),this.$bus.$on("hide-home-menu",this.hideMenu)},destroyed:function(){this.$bus.$off("show-home-menu",this.showMenu),this.$bus.$off("hide-home-menu",this.hideMenu)}},Z=X,ee=(n("3442"),Object(d["a"])(Z,s,r,!1,null,"f382e350",null));ee.options.__file="Home.vue";t["default"]=ee.exports},bdfa:function(e,t,n){},c4bd:function(e,t,n){},c60c:function(e,t,n){},c911:function(e,t,n){"use strict";var s=n("c60c"),r=n.n(s);r.a},d15c:function(e,t,n){"use strict";var s=n("5e66"),r=n.n(s);r.a},e88e:function(e,t,n){"use strict";var s=n("15f0"),r=n.n(s);r.a},fab3:function(e,t,n){"use strict";(function(e){n("28a5"),n("6762"),n("2fdb"),n("a481"),n("ac4d"),n("8a81"),n("ac6a"),n("7f7f");var s=n("8afe"),r=(n("55dd"),n("96cf"),n("3040")),i=(n("7514"),n("24fd")),a=n("b05c"),o=n("3f5e"),c=n("b61d"),u=n("8176"),l=0,d=1,p=2,m=1,f=2;t["a"]={name:"member",data:function(){return{validateCaptcha:c["validateCaptcha"],sendSmsCode:c["sendSmsCode"],sendEmailVcode:c["sendEmailVcode"],constMap:{admin:l,manager:d,normalUser:p,networkLocal:m,networkInternet:f},memberList:[],emailSentList:[],showInvite:!1,inviteeList:[],networkType:f,userTypeList:[],sortInfo:{sortType:"userType",reverse:1},sortOptions:[{value:"userType",label:"权限"},{value:"state",label:"认证状态"}],editing:{show:!1,info:{},rebind:{show:!1,needVerified:!0,frozen:!1,imageCode:"",verifyCode:"",phone:"",email:"",type:"",verifyImage:"",imageUUID:""}},grid:{left:16,right:8}}},computed:{userInfo:function(){var e=this;return this.memberList.find(function(t){return e.$store.state.user.userInfo.id===t.id})||{}},isLocalNetwork:function(){return this.networkType===m},isInternetNetwork:function(){return this.networkType===f},isAdmin:function(){return this.userInfo.userType===l},isManager:function(){return this.userInfo.userType===d||this.userInfo.userType===l},isNormalManager:function(){return this.userInfo.userType===d},isNormalUser:function(){return this.userInfo.userType===p}},mounted:function(){this.refreshPage(),this.getUserType()},methods:{refreshPage:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["default"].getMemberList();case 2:t=e.sent,t&&(this.memberList=t,this.sortMemberList());case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),sortMemberList:function(){var e=this,t=["userType","state"];t.sort(function(t,n){return n===e.sortInfo.sortType}),this.memberList.sort(function(n,s){for(var r=0;r<t.length;r++){var i=t[r],a=(n[i]-s[i])*e.sortInfo.reverse;if(a)return a}return 0})},sendAllEmail:function(){var e=[];this.memberList.map(function(t){return t.state&&e.push(t.id)}),e.length?this.emailAuthenticate(e):this.$Message.success("用户列表中没有未认证成员")},emailAuthenticate:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["default"].emailAuthenticate({ids:t});case 2:n=e.sent,n?(this.$Message.success("激活邮件发送成功"),(r=this.emailSentList).push.apply(r,Object(s["a"])(t))):this.$Message.error("激活邮件发送失败");case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),showInviteDialog:function(){this.showInvite=!0,this.addInvitee()},getUserType:function(){var e=this;Object(a["getUserType"])().then(function(t){t.response.success?e.userTypeList=t.data:e.$Message.error("获取成员类型失败!")})},addInvitee:function(e){var t={email:"",phone:"",name:"",userType:d};e?this.inviteeList.splice(e+1,0,t):this.inviteeList.push(t)},deleteInvitee:function(e){this.inviteeList.length<=1||this.inviteeList.splice(e,1)},submitInviteeInfo:function(){var e=this;if(this.checkForm()){var t=this.filterEmptyInviteeData();if(t.length){var n={networkType:this.networkType,users:t};Object(a["addUsers"])(n).then(function(t){t.response.success&&(e.isInternetNetwork&&e.$Message.success({content:"已给所有新添加用户发送认证邮件！",duration:5,closable:!0}),e.clearInviteeInfo(),e.refreshPage())})}else this.$Message.error("未填写任何有效数据")}},clearInviteeInfo:function(){this.showInvite=!1,this.inviteeList=[]},checkForm:function(){for(var e in this.inviteeList){var t=this.inviteeList[e];if(this.isLocalNetwork&&t.phone+t.name===(t.phone||t.name))return this.$Message.error("信息未填写完整"),!1}return!0},filterEmptyInviteeData:function(){var e=[],t=!0,n=!1,s=void 0;try{for(var r,i=this.inviteeList[Symbol.iterator]();!(t=(r=i.next()).done);t=!0){var a=r.value;(this.isLocalNetwork&&a.phone&&a.name.replace(/\s+/g,"")||this.isInternetNetwork&&a.email.replace(/\s+/g,""))&&e.push(a)}}catch(e){n=!0,s=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw s}}return e},checkKeyUp:function(e){if(!this.$bus.inputing){var t=a(e.target),n=t.id||"",s=n.split("__");if(s.length){"ArrowUp"===e.key?s[1]=+s[1]-1+"":"ArrowDown"===e.key?s[1]=+s[1]+1+"":"ArrowLeft"===e.key?s[2]=+s[2]-1+"":"ArrowRight"===e.key&&(s[2]=+s[2]+1+"");var r=s.join("__"),i=document.getElementById(r);i&&i.__vue__.focus()}}function a(e){while(e!==document.body&&!e.className.includes("invitee__input"))e=e.parentNode;return e}},deleteMember:function(e){var t=this;this.$Modal.confirm({render:function(t){return t("div",{domProps:{innerText:"确定删除成员".concat(e.name?e.name:"","吗？")}})},onOk:function(){return t.confirmDeleteMember([e.id])}})},confirmDeleteMember:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i["default"].deleteCompanyMember({ids:t});case 2:n=e.sent,n?(this.refreshPage(),this.$Message.success("删除成功")):this.$Message.error("删除失败");case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),setTobeManager:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t,n){var s,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return s={ids:[t.id],userType:n},e.next=3,i["default"].setCompanyUserType(s);case 3:r=e.sent,r?(t.userType=n,this.$Message.success("设置成功")):this.$Message.error("设置失败");case 5:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),editMemberInfo:function(t){this.editing.info=e.cloneDeep(t),this.editing.show=!0},selectImage:function(){this.$refs.avatarInput.click()},uploadImage:function(e){var t=this;if(e.target.files.length){var n=e.target.files[0];Object(o["uploadFile"])(n).then(function(e){t.editing.info.avatar=e.data,t.$store.commit("user/setUserInfo",t.userInfo)})}},rebind:function(e){this.editing.rebind.show=!0,this.editing.rebind.frozen=!1,this.editing.rebind.type=e,this.editing.rebind.phone="",this.editing.rebind.email="",this.getNewVerifyImage()},getNewVerifyImage:function(){var e=this;this.editing.rebind.verifyImage="",this.editing.rebind.imageUUID="",this.editing.rebind.imageCode="",Object(c["getCaptcha"])().then(function(t){t.response.success&&(e.editing.rebind.verifyImage="data:image;base64,".concat(t.data.image),e.editing.rebind.imageUUID=t.data.uuid,e.$refs.rebindImage.focus())})},getVerifyCode:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.editing.rebind.imageCode){e.next=3;break}return this.$Message.warning("请输入验证码"),e.abrupt("return");case 3:if("phone"!==this.editing.rebind.type||this.editing.rebind.phone){e.next=9;break}return this.$refs.rebindPhone.focus(),this.$Message.warning("请输入正确手机号"),e.abrupt("return");case 9:if("email"!==this.editing.rebind.type||this.editing.rebind.email){e.next=13;break}return this.$refs.rebindEmail.focus(),this.$Message.warning("请输入正确邮箱账号"),e.abrupt("return");case 13:return this.editing.rebind.frozen=!0,t={captcha:this.editing.reBind.imageCode,uuid:this.editing.reBind.imageUUID},e.next=17,Object(c["validateCaptcha"])(t);case 17:if(n=e.sent,n.response.success){e.next=23;break}return this.$Message.error({content:"验证码错误，请重新输入",duration:3,closable:!0}),this.$refs.rebindImage.focus(),this.editing.rebind.frozen=!1,e.abrupt("return");case 23:"phone"===this.editing.rebind.type?this.getPhoneVerifyCode():this.getEmailVerifyCode();case 24:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getPhoneVerifyCode:function(){var e=this,t={phone:this.editing.rebind.phone,type:3,captcha:this.editing.rebind.imageCode,captchaUuid:this.editing.rebind.imageUUID};Object(c["sendSmsCode"])(t).then(function(t){t.response.success?(e.$Message.success({content:"验证码已发送，请查看手机短信",duration:3,closable:!0}),e.$refs.rebindCode.focus()):(e.$Message.error("验证码发送失败"),e.editing.rebind.frozen=!1,e.$refs.rebindPhone.focus())})},getEmailVerifyCode:function(){var e=this,t={email:this.editing.rebind.email,type:1,captcha:this.editing.rebind.imageCode,captchaUuid:this.editing.rebind.imageUUID};Object(c["sendEmailVcode"])(t).then(function(t){t.response.success?(e.$Message.success({content:"验证码已发送到新邮箱，请登录邮箱查看",duration:3,closable:!0}),e.$refs.rebindCode.focus()):(e.$Message.error("验证码发送失败"),e.editing.rebind.frozen=!1,e.$refs.rebindEmail.focus())})},saveRebind:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(this.editing.rebind.verifyCode){e.next=3;break}return this.$Message.error("请输入验证码！"),e.abrupt("return");case 3:t={id:this.editing.info.id,smsVcode:this.editing.rebind.verifyCode},"phone"===this.editing.rebind.type?(t.phone=this.editing.rebind.phone,Object(u["savePhone"])(t).then(function(e){e.response.success?(n.editing.info.phone=t.phone,n.$Message.success("手机号绑定成功"),n.editing.rebind.show=!1):n.$Message.error(e.response.msg)})):(t.email=this.editing.rebind.email,Object(u["saveEmail"])(t).then(function(e){e.response.success?(n.editing.info.email=t.email,n.$Message.success("邮箱绑定成功"),n.editing.rebind.show=!1):n.$Message.error(e.response.msg)}));case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),clearEditingInfo:function(){this.editing.show=!1,this.editing.info={}},saveEditingInfo:function(){var t=this;Object(u["saveAccountInfo"])(this.editing.info).then(function(n){if(n.response.success){if(t.$Message.success("保存成功"),t.editing.info.id===t.userInfo.id){var s=e.cloneDeep(t.$store.state.user.userInfo);for(var r in s)s[r]=t.editing.info[r]||s[r];t.$store.commit("user/setUserInfo",s)}t.refreshPage(),t.clearEditingInfo()}else t.$Message.error("保存失败")})}},watch:{sortInfo:{deep:!0,handler:function(e,t){this.sortMemberList()}}}}}).call(this,n("2ef0"))}}]);
//# sourceMappingURL=chunk-20e65cc9.7988c838.js.map