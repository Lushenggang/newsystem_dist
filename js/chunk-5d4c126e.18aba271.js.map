{"version":3,"sources":["webpack:///./src/pages/BindWX.vue?6eee","webpack:///src/pages/BindWX.vue","webpack:///./src/pages/BindWX.vue?05b3","webpack:///./src/pages/BindWX.vue","webpack:///./src/components/weixin-login/weixin-login.vue?161a","webpack:///src/components/weixin-login/weixin-login.vue","webpack:///./src/components/weixin-login/weixin-login.vue?c88f","webpack:///./src/components/weixin-login/weixin-login.vue","webpack:///./src/components/weixin-login/index.js","webpack:///./src/pages/BindWX.vue?1f23"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","title","type","on","success","wxLoginSuccess","staticRenderFns","BindWXvue_type_script_lang_js_","name","components","weixinLogin","weixin_login","methods","code","_this","Object","weixin","then","resp","response","bindSuccess","data","token","user","console","error","bindFailed","msg","catch","err","loginFailed","userInfo","_this2","localUserInfo","deepCopy","$store","getters","id","unionid","commit","$router","replace","$Message","pages_BindWXvue_type_script_lang_js_","component","componentNormalizer","options","__file","__webpack_exports__","_v","_s","src","qrCode","wxLoginMsg","weixin_loginvue_type_script_lang_js_","props","String","required","default","wxUUID","created","getQRCode","login","_ref","status","result","imgData","getWxCode","uuid","_ref2","$emit","content","timer","setTimeout","clearTimeout","log","weixin_login_weixin_loginvue_type_script_lang_js_","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_BindWX_vue_vue_type_style_index_0_id_3ac0c16e_lang_stylus_scoped_true___WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","_node_modules_mini_css_extract_plugin_dist_loader_js_ref_11_oneOf_1_0_node_modules_css_loader_index_js_ref_11_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_11_oneOf_1_2_node_modules_stylus_loader_index_js_ref_11_oneOf_1_3_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_BindWX_vue_vue_type_style_index_0_id_3ac0c16e_lang_stylus_scoped_true___WEBPACK_IMPORTED_MODULE_0___default","n"],"mappings":"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","file":"js/chunk-5d4c126e.18aba271.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Layout',{staticClass:\"bind-wx-page\"},[_c('weixinLogin',{attrs:{\"title\":'扫描二维码绑定微信',\"type\":'bind'},on:{\"success\":_vm.wxLoginSuccess}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template lang=\"pug\">\nLayout.bind-wx-page\n  weixinLogin(:title=\"'扫描二维码绑定微信'\" :type=\"'bind'\" @success=\"wxLoginSuccess\")\n</template>\n\n<script>\nimport weixinLogin from '@/components/weixin-login'\nimport { bindWx, wxLogin } from '../api/weixin'\n\nexport default {\n  name: 'force-bind-wx',\n  components: {\n    weixinLogin\n  },\n  methods: {\n    wxLoginSuccess (code) {\n      wxLogin({ code }).then(resp => {\n        if (resp.response.success) {\n          this.bindSuccess(resp.data.token, resp.data.user)\n        } else {\n          console.error('微信登录失败')\n          this.bindFailed(resp.response.msg)\n        }\n      }).catch(err => {\n        console.error(err)\n        this.loginFailed(err)\n      })\n    },\n    bindSuccess (token, userInfo) {\n      const localUserInfo = this.deepCopy(this.$store.getters['user/userInfo'])\n      bindWx({ id: localUserInfo.id, unionid: userInfo.unionid }).then(resp => {\n        if (resp.response.success) {\n          localUserInfo.unionid = userInfo.unionid\n          this.$store.commit('user/setUserInfo', localUserInfo)\n          this.$router.replace({ name: 'Home' })\n        } else {\n          this.$Message.error(resp.response.msg)\n        }\n      }).catch(err => {\n        console.error(err)\n      })\n    },\n    bindFailed (msg) {\n      this.$Message.error(msg)\n    }\n  }\n}\n</script>\n\n<style lang=\"stylus\" scoped>\n.bind-wx-page\n  height 100%\n  display flex\n  align-items center\n\n  .bind-wx-body\n    margin 0.5rem\n  .bind-wx-footer\n    .success-icon\n      color rgb(41, 189, 110)\n      font-size 1rem\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BindWX.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BindWX.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./BindWX.vue?vue&type=template&id=3ac0c16e&scoped=true&lang=pug&\"\nimport script from \"./BindWX.vue?vue&type=script&lang=js&\"\nexport * from \"./BindWX.vue?vue&type=script&lang=js&\"\nimport style0 from \"./BindWX.vue?vue&type=style&index=0&id=3ac0c16e&lang=stylus&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3ac0c16e\",\n  null\n  \n)\n\ncomponent.options.__file = \"BindWX.vue\"\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('Layout',[_c('div',{attrs:{\"id\":\"qrcode\"}},[_c('h2',[_vm._v(_vm._s(_vm.title))]),_c('img',{attrs:{\"src\":_vm.qrCode}}),_c('div',{staticClass:\"show-msg\"},[_vm._v(_vm._s(_vm.wxLoginMsg))])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <Layout>\n    <div id=\"qrcode\">\n      <h2>{{title}}</h2>\n      <img :src=\"qrCode\">\n      <div class=\"show-msg\">{{wxLoginMsg}}</div>\n    </div>\n  </Layout>\n</template>\n\n<script>\nimport { getQRCode, getWxCode } from '@/api/login'\nexport default {\n  name: 'weixin-login',\n  props: {\n    type: {\n      type: String,\n      required: false,\n      default: 'login'\n    },\n    title: String\n  },\n  data () {\n    return {\n      wxUUID: '',\n      qrCode: '',\n      wxLoginMsg: '请用微信扫描二维码登录'\n    }\n  },\n  created () {\n    this.getQRCode()\n  },\n  methods: {\n    getQRCode () {\n      getQRCode().then(({ status, result }) => {\n        this.wxUUID = result.wxUUID\n        this.qrCode = result.imgData\n        this.getWxCode(this.wxUUID)\n      })\n    },\n    getWxCode () {\n      getWxCode({\n        uuid: this.wxUUID\n      }).then(({ result, status, msg }) => {\n        if (status && status === 405) {\n          this.wxLoginMsg = msg\n          this.$emit('success', result.code)\n        } else if (status === 500) {\n          this.getQRCode()\n        } else {\n          if (status && status === 404) {\n            this.wxLoginMsg = msg.title + ', ' + msg.content\n          }\n          const timer = setTimeout(() => {\n            this.getWxCode()\n            clearTimeout(timer)\n          }, 2000)\n          console.log(result)\n        }\n      }).catch(err => {\n        const timer = setTimeout(() => {\n          this.getWxCode()\n          clearTimeout(timer)\n        }, 2000)\n        console.error(err)\n      })\n    }\n  }\n}\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./weixin-login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./weixin-login.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./weixin-login.vue?vue&type=template&id=6ac4b36c&\"\nimport script from \"./weixin-login.vue?vue&type=script&lang=js&\"\nexport * from \"./weixin-login.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\ncomponent.options.__file = \"weixin-login.vue\"\nexport default component.exports","import weixinLogin from './weixin-login'\nexport default weixinLogin\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BindWX.vue?vue&type=style&index=0&id=3ac0c16e&lang=stylus&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../node_modules/css-loader/index.js??ref--11-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/lib/index.js??ref--11-oneOf-1-2!../../node_modules/stylus-loader/index.js??ref--11-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./BindWX.vue?vue&type=style&index=0&id=3ac0c16e&lang=stylus&scoped=true&\""],"sourceRoot":""}