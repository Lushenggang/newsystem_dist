(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-063a319c"],{1377:function(e,t,a){"use strict";var n=a("638e"),o=a.n(n);o.a},"15e3":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Cascader",{attrs:{data:e.professionalData,"change-on-select":""},on:{"on-change":e.select},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})},o=[],s=(a("7f7f"),a("ac4d"),a("8a81"),a("ac6a"),a("f400"),a("c5f6"),a("e668")),l={name:"professional-selector",props:{professionalId:{type:Number|String,required:!0}},data:function(){return{selected:[],professionalData:[],professionalMap:new Map}},created:function(){this.getProfessionalList()},watch:{professionalId:function(){this.makeSelected()}},computed:{},methods:{getProfessionalList:function(){var e=this;Object(s["getProfessionalList"])({}).then(function(t){t.response.success?(e.professionalData=e.makeData(t.data),e.makeSelected()):e.$Message.error(t.response.msg)}).catch(function(e){console.error(e)})},select:function(e,t){this.$emit("on-select",t[t.length-1])},makeData:function(e){var t=[],a=[],n=!0,o=!1,s=void 0;try{for(var l,r=e[Symbol.iterator]();!(n=(l=r.next()).done);n=!0){var c=l.value;c.value=c.id,c.label=c.name,this.professionalMap.set(c.id,c),c.parentId?a.push(c):t.push(c)}}catch(e){o=!0,s=e}finally{try{n||null==r.return||r.return()}finally{if(o)throw s}}for(var i=0;i<a.length;i++){var u=a[i],d=this.professionalMap.get(u.parentId);if(!d)return;d.children?d.children.push(u):d.children=[u]}return t},makeSelected:function(){if(this.professionalId&&this.professionalMap.size){this.selected=[this.professionalId];var e=this.professionalMap.get(this.professionalId),t=e?this.professionalMap.get(e.parentId):null;while(t)this.selected.splice(0,0,t.id),t=this.professionalMap.get(t.parentId)}}}},r=l,c=(a("1377"),a("2877")),i=Object(c["a"])(r,n,o,!1,null,null,null);i.options.__file="professional-selector.vue";var u=i.exports;t["a"]=u},3693:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("Layout",{staticClass:"document-detail-page"},[a("Row",{staticClass:"tool-bar"},[a("a",{attrs:{href:"javascript: void(0)"},on:{click:function(t){e.$router.go(-1)}}},[a("icon",{attrs:{type:"ios-arrow-back"}}),e._v("\n      返回\n    ")],1),a("div",{staticClass:"buttons"},[a("Button",{attrs:{type:"primary",size:"small"},nativeOn:{click:function(t){return e.saveDocument(t)}}},[e._v("保存")])],1)]),a("Form",{ref:"formIns",staticClass:"document-form",attrs:{model:e.documentData,"label-width":36,inline:"",rules:e.validateRules}},[a("FormItem",{attrs:{label:"标题",prop:"title","label-width":48}},[a("Input",{model:{value:e.documentData.title,callback:function(t){e.$set(e.documentData,"title",t)},expression:"documentData.title"}})],1),a("FormItem",{attrs:{model:e.documentData,label:"分类"}},[a("professionalSelector",{attrs:{professionalId:e.documentData.professionId},on:{"on-select":function(t){e.documentData.professionId=t.id,e.documentData.tagInfo=[]}}})],1),a("FormItem",{attrs:{label:"标签"}},[a("tagSelector",{attrs:{professionalId:e.documentData.professionId},model:{value:e.documentData.tagInfo,callback:function(t){e.$set(e.documentData,"tagInfo",t)},expression:"documentData.tagInfo"}})],1),a("FormItem",{attrs:{label:"可见范围","label-width":60}},[a("Select",{model:{value:e.documentData.range,callback:function(t){e.$set(e.documentData,"range",t)},expression:"documentData.range"}},e._l(e.rangeData,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1),a("FormItem",{attrs:{label:"类型"}},[a("Select",{model:{value:e.documentData.type,callback:function(t){e.$set(e.documentData,"type",t)},expression:"documentData.type"}},e._l(e.typeData,function(t){return a("Option",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],1)],1),a("mavon-editor",{ref:"mdEditor",staticClass:"md-editor",attrs:{scrollStyle:!0,placeholder:"请输入内容"},on:{fullScreen:e.toggleFullScreen,change:e.contentChange,imgAdd:e.uploadImage},model:{value:e.documentData.content,callback:function(t){e.$set(e.documentData,"content",t)},expression:"documentData.content"}})],1)},o=[],s=(a("a481"),a("15e3")),l=a("5d0b"),r=a("424e"),c=a("3f5e"),i={name:"document-detail",components:{professionalSelector:s["a"],tagSelector:l["a"]},data:function(){var e={content:"",id:null,professionId:null,range:1,sort:0,tagInfo:[],title:"",type:2};return{fullScreen:!1,documentData:this.deepCopy(e),rangeData:[{label:"官方文档",value:1},{label:"内部文档",value:2}],typeData:[{label:"测试文档",value:2},{label:"操作文档",value:3}],validateRules:{title:[{required:!0,message:"请输入标题",trigger:"change"}]}}},created:function(){var e=this;"detail"===this.$route.params.type&&Object(r["getDocumentDetail"])({id:this.$route.params.id}).then(function(t){t.response.success&&(t.data.tagInfo=t.data.tagInfo?t.data.tagInfo:[],t.data.professionId=t.data.professionId?t.data.professionId:0,e.documentData=t.data)})},methods:{toggleFullScreen:function(e){this.$store.commit("layout/toggleFullScreen",!1)},contentChange:function(e,t){this.documentData.content=e},saveDocument:function(){var e=this;this.$refs.formIns.validate(function(t){t?Object(r["saveDocument"])(e.documentData).then(function(t){t.response.success&&(e.$Message.success("保存成功！"),e.$router.replace({name:"Document"}))}):e.$Message.error("请检查表单！")})},uploadImage:function(e,t){var a=this;Object(c["uploadFile"])(t).then(function(t){var n=t.data,o=t.response;if(o.success){var s=n,l=a.$avatarUrl.replace("avatarID",s);a.$refs.mdEditor.$img2Url(e,l)}})}}},u=i,d=(a("5346"),a("2877")),f=Object(d["a"])(u,n,o,!1,null,"2219a092",null);f.options.__file="DocumentDetail.vue";t["default"]=f.exports},5346:function(e,t,a){"use strict";var n=a("6a1f"),o=a.n(n);o.a},"638e":function(e,t,a){},"6a1f":function(e,t,a){}}]);
//# sourceMappingURL=chunk-063a319c.f0bc3997.js.map